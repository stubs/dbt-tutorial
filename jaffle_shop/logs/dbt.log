2022-06-19 20:36:52.323545 (MainThread): Running with dbt=0.21.1
2022-06-19 20:36:52.570503 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 20:36:52.571761 (MainThread): Tracking: tracking
2022-06-19 20:36:52.584140 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ecc18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ec780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ec860>]}
2022-06-19 20:36:52.595812 (MainThread): Partial parsing not enabled
2022-06-19 20:36:52.607161 (MainThread): Parsing macros/etc.sql
2022-06-19 20:36:52.610113 (MainThread): Parsing macros/catalog.sql
2022-06-19 20:36:52.616699 (MainThread): Parsing macros/adapters.sql
2022-06-19 20:36:52.638499 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 20:36:52.640824 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 20:36:52.643182 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 20:36:52.652118 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 20:36:52.654549 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 20:36:52.668449 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 20:36:52.669953 (MainThread): Parsing macros/core.sql
2022-06-19 20:36:52.673384 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 20:36:52.679719 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 20:36:52.689078 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 20:36:52.690609 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 20:36:52.706810 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 20:36:52.740075 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 20:36:52.761993 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 20:36:52.763603 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 20:36:52.773335 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 20:36:52.793137 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 20:36:52.806894 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 20:36:52.814790 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 20:36:52.821973 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 20:36:52.825564 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 20:36:52.826905 (MainThread): Parsing macros/etc/query.sql
2022-06-19 20:36:52.827770 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 20:36:52.829151 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 20:36:52.837217 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 20:36:52.838834 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 20:36:52.841094 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 20:36:52.842504 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 20:36:52.894950 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 20:36:52.896462 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 20:36:52.897496 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 20:36:52.898683 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 20:36:53.070341 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2022-06-19 20:36:53.081293 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2022-06-19 20:36:53.134484 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:36:53.135954 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:36:53.137334 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:36:53.138823 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:36:53.152818 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25e5c076-87c6-4fd3-b552-7d014c8882b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce20c88>]}
2022-06-19 20:36:53.156274 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25e5c076-87c6-4fd3-b552-7d014c8882b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce18ac8>]}
2022-06-19 20:36:53.156511 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 20:36:53.157256 (MainThread): 
2022-06-19 20:36:53.157573 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:36:53.158335 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 20:36:53.158537 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 20:36:53.580838 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 20:36:53.582103 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 20:36:53.582591 (ThreadPoolExecutor-0_0): Creating schema "agonzalez-dbt-tutorial.dbt_agonzalez".
2022-06-19 20:36:53.583223 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2022-06-19 20:36:53.590890 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:36:54.247446 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 20:36:54.248603 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 20:36:54.257517 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:36:54.663806 (MainThread): 16:36:54 | Concurrency: 1 threads (target='dev')
2022-06-19 20:36:54.664864 (MainThread): 16:36:54 | 
2022-06-19 20:36:54.669384 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2022-06-19 20:36:54.669720 (Thread-1): 16:36:54 | 1 of 2 START table model dbt_agonzalez.my_first_dbt_model............ [RUN]
2022-06-19 20:36:54.670069 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2022-06-19 20:36:54.670250 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2022-06-19 20:36:54.672274 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2022-06-19 20:36:54.672846 (Thread-1): finished collecting timing info
2022-06-19 20:36:54.705925 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2022-06-19 20:36:54.706655 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:36:54.714233 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2022-06-19 20:36:57.303283 (Thread-1): finished collecting timing info
2022-06-19 20:36:57.303701 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e5c076-87c6-4fd3-b552-7d014c8882b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e6e48>]}
2022-06-19 20:36:57.304049 (Thread-1): 16:36:57 | 1 of 2 OK created table model dbt_agonzalez.my_first_dbt_model....... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.63s]
2022-06-19 20:36:57.304237 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2022-06-19 20:36:57.304672 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2022-06-19 20:36:57.304963 (Thread-1): 16:36:57 | 2 of 2 START view model dbt_agonzalez.my_second_dbt_model............ [RUN]
2022-06-19 20:36:57.305285 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2022-06-19 20:36:57.305497 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2022-06-19 20:36:57.306094 (Thread-1): unclosed <ssl.SSLSocket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49762), raddr=('142.250.65.234', 443)>
2022-06-19 20:36:57.306399 (Thread-1): unclosed <ssl.SSLSocket fd=17, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49763), raddr=('142.251.35.170', 443)>
2022-06-19 20:36:57.308165 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2022-06-19 20:36:57.308589 (Thread-1): finished collecting timing info
2022-06-19 20:36:57.317546 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49756), raddr=('142.250.65.234', 443)>
2022-06-19 20:36:57.317807 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49757), raddr=('142.251.35.170', 443)>
2022-06-19 20:36:57.318029 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49758), raddr=('142.250.65.234', 443)>
2022-06-19 20:36:57.318217 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49759), raddr=('142.251.35.170', 443)>
2022-06-19 20:36:57.318400 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49760), raddr=('142.250.65.234', 443)>
2022-06-19 20:36:57.318655 (Thread-1): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49761), raddr=('142.251.35.170', 443)>
2022-06-19 20:36:57.324508 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2022-06-19 20:36:57.325110 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:36:57.332893 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`my_first_dbt_model`
where id = 1;


2022-06-19 20:36:58.274257 (Thread-1): finished collecting timing info
2022-06-19 20:36:58.275398 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e5c076-87c6-4fd3-b552-7d014c8882b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106fae80>]}
2022-06-19 20:36:58.275816 (Thread-1): 16:36:58 | 2 of 2 OK created view model dbt_agonzalez.my_second_dbt_model....... [OK in 0.97s]
2022-06-19 20:36:58.276009 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2022-06-19 20:36:58.285684 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:36:58.286822 (MainThread): 16:36:58 | 
2022-06-19 20:36:58.287013 (MainThread): 16:36:58 | Finished running 1 table model, 1 view model in 5.13s.
2022-06-19 20:36:58.287180 (MainThread): Connection 'master' was properly closed.
2022-06-19 20:36:58.287327 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2022-06-19 20:36:58.291041 (MainThread): 
2022-06-19 20:36:58.291234 (MainThread): Completed successfully
2022-06-19 20:36:58.291409 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-06-19 20:36:58.291630 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b16d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b413320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4132b0>]}
2022-06-19 20:36:58.291847 (MainThread): Flushing usage events
2022-06-19 20:47:43.220401 (MainThread): Running with dbt=0.21.1
2022-06-19 20:47:43.465759 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 20:47:43.466935 (MainThread): Tracking: tracking
2022-06-19 20:47:43.480646 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110397908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110397898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110397860>]}
2022-06-19 20:47:43.491340 (MainThread): Partial parsing not enabled
2022-06-19 20:47:43.501132 (MainThread): Parsing macros/etc.sql
2022-06-19 20:47:43.503634 (MainThread): Parsing macros/catalog.sql
2022-06-19 20:47:43.509850 (MainThread): Parsing macros/adapters.sql
2022-06-19 20:47:43.531144 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 20:47:43.533513 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 20:47:43.535855 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 20:47:43.544720 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 20:47:43.547148 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 20:47:43.560882 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 20:47:43.562359 (MainThread): Parsing macros/core.sql
2022-06-19 20:47:43.565748 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 20:47:43.571992 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 20:47:43.581139 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 20:47:43.582649 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 20:47:43.598514 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 20:47:43.630477 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 20:47:43.651940 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 20:47:43.653530 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 20:47:43.663291 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 20:47:43.682671 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 20:47:43.696075 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 20:47:43.703855 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 20:47:43.710895 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 20:47:43.714434 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 20:47:43.715784 (MainThread): Parsing macros/etc/query.sql
2022-06-19 20:47:43.716655 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 20:47:43.718056 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 20:47:43.726068 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 20:47:43.727703 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 20:47:43.729943 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 20:47:43.731354 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 20:47:43.782568 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 20:47:43.784090 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 20:47:43.785146 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 20:47:43.786354 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 20:47:43.962514 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:47:43.972495 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2022-06-19 20:47:43.975406 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2022-06-19 20:47:44.028343 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:47:44.029899 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:47:44.031308 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:47:44.032721 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:47:44.045748 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '011c5083-8ee2-422a-806a-047e64b0c55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a0d30>]}
2022-06-19 20:47:44.049276 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '011c5083-8ee2-422a-806a-047e64b0c55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccba128>]}
2022-06-19 20:47:44.049512 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 20:47:44.050277 (MainThread): 
2022-06-19 20:47:44.050619 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:47:44.051497 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 20:47:44.051757 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 20:47:44.553670 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 20:47:44.554821 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 20:47:44.563872 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:47:44.964169 (MainThread): 16:47:44 | Concurrency: 1 threads (target='dev')
2022-06-19 20:47:44.965366 (MainThread): 16:47:44 | 
2022-06-19 20:47:44.968050 (Thread-1): Began running node model.jaffle_shop.customers
2022-06-19 20:47:44.968439 (Thread-1): 16:47:44 | 1 of 3 START view model dbt_agonzalez.customers...................... [RUN]
2022-06-19 20:47:44.968879 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:47:44.969069 (Thread-1): Compiling model.jaffle_shop.customers
2022-06-19 20:47:44.970335 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2022-06-19 20:47:44.970798 (Thread-1): finished collecting timing info
2022-06-19 20:47:44.994000 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2022-06-19 20:47:44.994540 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:47:45.002218 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2022-06-19 20:47:46.198776 (Thread-1): finished collecting timing info
2022-06-19 20:47:46.199256 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '011c5083-8ee2-422a-806a-047e64b0c55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104e2e80>]}
2022-06-19 20:47:46.199735 (Thread-1): 16:47:46 | 1 of 3 OK created view model dbt_agonzalez.customers................. [OK in 1.23s]
2022-06-19 20:47:46.199931 (Thread-1): Finished running node model.jaffle_shop.customers
2022-06-19 20:47:46.200144 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2022-06-19 20:47:46.200524 (Thread-1): 16:47:46 | 2 of 3 START table model dbt_agonzalez.my_first_dbt_model............ [RUN]
2022-06-19 20:47:46.200865 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2022-06-19 20:47:46.201050 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2022-06-19 20:47:46.203110 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2022-06-19 20:47:46.203557 (Thread-1): finished collecting timing info
2022-06-19 20:47:46.216167 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:47:46.223737 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:47:46.590159 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2022-06-19 20:47:46.590668 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2022-06-19 20:47:49.126325 (Thread-1): finished collecting timing info
2022-06-19 20:47:49.127925 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '011c5083-8ee2-422a-806a-047e64b0c55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103f66a0>]}
2022-06-19 20:47:49.128951 (Thread-1): 16:47:49 | 2 of 3 OK created table model dbt_agonzalez.my_first_dbt_model....... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.93s]
2022-06-19 20:47:49.129272 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2022-06-19 20:47:49.129783 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2022-06-19 20:47:49.130091 (Thread-1): 16:47:49 | 3 of 3 START view model dbt_agonzalez.my_second_dbt_model............ [RUN]
2022-06-19 20:47:49.130459 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2022-06-19 20:47:49.130677 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2022-06-19 20:47:49.132149 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49860), raddr=('142.250.64.74', 443)>
2022-06-19 20:47:49.132443 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49861), raddr=('142.251.40.202', 443)>
2022-06-19 20:47:49.132647 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49862), raddr=('142.250.64.74', 443)>
2022-06-19 20:47:49.132832 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49863), raddr=('142.251.40.202', 443)>
2022-06-19 20:47:49.133019 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49864), raddr=('142.250.64.74', 443)>
2022-06-19 20:47:49.133204 (Thread-1): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49865), raddr=('142.251.40.202', 443)>
2022-06-19 20:47:49.133391 (Thread-1): unclosed <ssl.SSLSocket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49867), raddr=('142.250.64.74', 443)>
2022-06-19 20:47:49.133570 (Thread-1): unclosed <ssl.SSLSocket fd=17, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49868), raddr=('142.251.40.202', 443)>
2022-06-19 20:47:49.134896 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2022-06-19 20:47:49.135423 (Thread-1): finished collecting timing info
2022-06-19 20:47:49.136939 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2022-06-19 20:47:49.137273 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:47:49.144917 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`my_first_dbt_model`
where id = 1;


2022-06-19 20:47:50.172808 (Thread-1): finished collecting timing info
2022-06-19 20:47:50.173601 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '011c5083-8ee2-422a-806a-047e64b0c55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110490e10>]}
2022-06-19 20:47:50.174031 (Thread-1): 16:47:50 | 3 of 3 OK created view model dbt_agonzalez.my_second_dbt_model....... [OK in 1.04s]
2022-06-19 20:47:50.174233 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2022-06-19 20:47:50.269002 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:47:50.270372 (MainThread): 16:47:50 | 
2022-06-19 20:47:50.270980 (MainThread): 16:47:50 | Finished running 2 view models, 1 table model in 6.22s.
2022-06-19 20:47:50.271560 (MainThread): Connection 'master' was properly closed.
2022-06-19 20:47:50.272064 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2022-06-19 20:47:50.274625 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49869), raddr=('142.250.64.74', 443)>
2022-06-19 20:47:50.275083 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49871), raddr=('142.251.40.202', 443)>
2022-06-19 20:47:50.278863 (MainThread): 
2022-06-19 20:47:50.279074 (MainThread): Completed successfully
2022-06-19 20:47:50.279273 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-06-19 20:47:50.279497 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110490748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110490e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110659c18>]}
2022-06-19 20:47:50.279727 (MainThread): Flushing usage events
2022-06-19 20:48:20.147393 (MainThread): Running with dbt=0.21.1
2022-06-19 20:48:20.392393 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customers'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 20:48:20.393579 (MainThread): Tracking: tracking
2022-06-19 20:48:20.408390 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b22860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b22550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b22ac8>]}
2022-06-19 20:48:20.419178 (MainThread): Partial parsing not enabled
2022-06-19 20:48:20.428662 (MainThread): Parsing macros/etc.sql
2022-06-19 20:48:20.431143 (MainThread): Parsing macros/catalog.sql
2022-06-19 20:48:20.437413 (MainThread): Parsing macros/adapters.sql
2022-06-19 20:48:20.458191 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 20:48:20.460477 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 20:48:20.462789 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 20:48:20.471542 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 20:48:20.473939 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 20:48:20.487409 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 20:48:20.488882 (MainThread): Parsing macros/core.sql
2022-06-19 20:48:20.492162 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 20:48:20.498221 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 20:48:20.507364 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 20:48:20.508934 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 20:48:20.524944 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 20:48:20.557900 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 20:48:20.579472 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 20:48:20.581090 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 20:48:20.590869 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 20:48:20.610092 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 20:48:20.623391 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 20:48:20.631302 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 20:48:20.638416 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 20:48:20.641905 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 20:48:20.643245 (MainThread): Parsing macros/etc/query.sql
2022-06-19 20:48:20.644108 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 20:48:20.645513 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 20:48:20.653426 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 20:48:20.655030 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 20:48:20.657231 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 20:48:20.658635 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 20:48:20.709464 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 20:48:20.711008 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 20:48:20.712056 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 20:48:20.713252 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 20:48:20.886312 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:48:20.896492 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2022-06-19 20:48:20.899420 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2022-06-19 20:48:20.952899 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:48:20.954418 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:48:20.955776 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:48:20.957140 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:48:20.970024 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d079f24-6ce1-4387-86dd-8003b37b6ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111223438>]}
2022-06-19 20:48:20.973533 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d079f24-6ce1-4387-86dd-8003b37b6ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111453048>]}
2022-06-19 20:48:20.973769 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 20:48:20.974456 (MainThread): 
2022-06-19 20:48:20.974822 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:48:20.975627 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 20:48:20.975870 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 20:48:21.403075 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 20:48:21.404110 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 20:48:21.412586 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:48:21.800615 (MainThread): 16:48:21 | Concurrency: 1 threads (target='dev')
2022-06-19 20:48:21.801634 (MainThread): 16:48:21 | 
2022-06-19 20:48:21.804103 (Thread-1): Began running node model.jaffle_shop.customers
2022-06-19 20:48:21.804499 (Thread-1): 16:48:21 | 1 of 1 START view model dbt_agonzalez.customers...................... [RUN]
2022-06-19 20:48:21.804935 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:48:21.805114 (Thread-1): Compiling model.jaffle_shop.customers
2022-06-19 20:48:21.806317 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2022-06-19 20:48:21.806764 (Thread-1): finished collecting timing info
2022-06-19 20:48:21.829790 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2022-06-19 20:48:21.830411 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:48:21.838117 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2022-06-19 20:48:22.977658 (Thread-1): finished collecting timing info
2022-06-19 20:48:22.978113 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d079f24-6ce1-4387-86dd-8003b37b6ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c26ac8>]}
2022-06-19 20:48:22.978500 (Thread-1): 16:48:22 | 1 of 1 OK created view model dbt_agonzalez.customers................. [OK in 1.17s]
2022-06-19 20:48:22.978690 (Thread-1): Finished running node model.jaffle_shop.customers
2022-06-19 20:48:23.039695 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:48:23.040056 (MainThread): 16:48:23 | 
2022-06-19 20:48:23.040233 (MainThread): 16:48:23 | Finished running 1 view model in 2.07s.
2022-06-19 20:48:23.040401 (MainThread): Connection 'master' was properly closed.
2022-06-19 20:48:23.040552 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2022-06-19 20:48:23.041421 (MainThread): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49883), raddr=('142.250.64.74', 443)>
2022-06-19 20:48:23.041772 (MainThread): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49884), raddr=('142.251.40.202', 443)>
2022-06-19 20:48:23.044691 (MainThread): 
2022-06-19 20:48:23.044881 (MainThread): Completed successfully
2022-06-19 20:48:23.045054 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-06-19 20:48:23.045289 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145f5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11142fac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c26ac8>]}
2022-06-19 20:48:23.045543 (MainThread): Flushing usage events
2022-06-19 20:51:13.379129 (MainThread): Running with dbt=0.21.1
2022-06-19 20:51:13.623549 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customers'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 20:51:13.624690 (MainThread): Tracking: tracking
2022-06-19 20:51:13.638612 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a52cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a52860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a52a90>]}
2022-06-19 20:51:13.649080 (MainThread): Partial parsing not enabled
2022-06-19 20:51:13.658548 (MainThread): Parsing macros/etc.sql
2022-06-19 20:51:13.660997 (MainThread): Parsing macros/catalog.sql
2022-06-19 20:51:13.667271 (MainThread): Parsing macros/adapters.sql
2022-06-19 20:51:13.688112 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 20:51:13.690440 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 20:51:13.692769 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 20:51:13.701544 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 20:51:13.703948 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 20:51:13.717588 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 20:51:13.719058 (MainThread): Parsing macros/core.sql
2022-06-19 20:51:13.722404 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 20:51:13.728588 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 20:51:13.737643 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 20:51:13.739148 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 20:51:13.755045 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 20:51:13.788238 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 20:51:13.809843 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 20:51:13.811447 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 20:51:13.821311 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 20:51:13.840589 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 20:51:13.853663 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 20:51:13.861560 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 20:51:13.868596 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 20:51:13.872033 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 20:51:13.873347 (MainThread): Parsing macros/etc/query.sql
2022-06-19 20:51:13.874191 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 20:51:13.875583 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 20:51:13.883407 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 20:51:13.885011 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 20:51:13.887221 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 20:51:13.888607 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 20:51:13.938724 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 20:51:13.940248 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 20:51:13.941301 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 20:51:13.942487 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 20:51:14.114653 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:51:14.124638 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2022-06-19 20:51:14.127526 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2022-06-19 20:51:14.179589 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:51:14.181113 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:51:14.182491 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:51:14.183869 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:51:14.196877 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31b5471e-f820-4498-9f97-fd5320e5b39d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111375278>]}
2022-06-19 20:51:14.200493 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31b5471e-f820-4498-9f97-fd5320e5b39d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113838d0>]}
2022-06-19 20:51:14.200730 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 20:51:14.201446 (MainThread): 
2022-06-19 20:51:14.201749 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:51:14.202478 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 20:51:14.202716 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 20:51:14.618546 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 20:51:14.619603 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 20:51:14.627609 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:51:15.028253 (MainThread): 16:51:15 | Concurrency: 1 threads (target='dev')
2022-06-19 20:51:15.029261 (MainThread): 16:51:15 | 
2022-06-19 20:51:15.031852 (Thread-1): Began running node model.jaffle_shop.customers
2022-06-19 20:51:15.032185 (Thread-1): 16:51:15 | 1 of 1 START table model dbt_agonzalez.customers..................... [RUN]
2022-06-19 20:51:15.032547 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:51:15.032727 (Thread-1): Compiling model.jaffle_shop.customers
2022-06-19 20:51:15.033989 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2022-06-19 20:51:15.034425 (Thread-1): finished collecting timing info
2022-06-19 20:51:15.050871 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:51:15.058698 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:51:15.463001 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:51:15.631390 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2022-06-19 20:51:15.631969 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2022-06-19 20:51:18.122056 (Thread-1): finished collecting timing info
2022-06-19 20:51:18.122555 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b5471e-f820-4498-9f97-fd5320e5b39d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f8a3c8>]}
2022-06-19 20:51:18.122902 (Thread-1): 16:51:18 | 1 of 1 OK created table model dbt_agonzalez.customers................ [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.09s]
2022-06-19 20:51:18.123113 (Thread-1): Finished running node model.jaffle_shop.customers
2022-06-19 20:51:18.133339 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:51:18.133649 (MainThread): 16:51:18 | 
2022-06-19 20:51:18.133820 (MainThread): 16:51:18 | Finished running 1 table model in 3.93s.
2022-06-19 20:51:18.133984 (MainThread): Connection 'master' was properly closed.
2022-06-19 20:51:18.134134 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2022-06-19 20:51:18.137661 (MainThread): 
2022-06-19 20:51:18.137850 (MainThread): Completed successfully
2022-06-19 20:51:18.138038 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-06-19 20:51:18.138261 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b5c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bec860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bec4a8>]}
2022-06-19 20:51:18.138489 (MainThread): Flushing usage events
2022-06-19 20:52:11.361024 (MainThread): Running with dbt=0.21.1
2022-06-19 20:52:11.606749 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customers'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 20:52:11.607836 (MainThread): Tracking: tracking
2022-06-19 20:52:11.620911 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbd6898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbd67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbd67b8>]}
2022-06-19 20:52:11.631716 (MainThread): Partial parsing not enabled
2022-06-19 20:52:11.641223 (MainThread): Parsing macros/etc.sql
2022-06-19 20:52:11.643691 (MainThread): Parsing macros/catalog.sql
2022-06-19 20:52:11.649882 (MainThread): Parsing macros/adapters.sql
2022-06-19 20:52:11.670731 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 20:52:11.673006 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 20:52:11.675317 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 20:52:11.684047 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 20:52:11.686469 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 20:52:11.700150 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 20:52:11.701666 (MainThread): Parsing macros/core.sql
2022-06-19 20:52:11.705026 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 20:52:11.711218 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 20:52:11.720359 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 20:52:11.721863 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 20:52:11.738210 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 20:52:11.770568 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 20:52:11.791986 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 20:52:11.793587 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 20:52:11.803212 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 20:52:11.822214 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 20:52:11.835406 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 20:52:11.843065 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 20:52:11.849983 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 20:52:11.853594 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 20:52:11.854944 (MainThread): Parsing macros/etc/query.sql
2022-06-19 20:52:11.855812 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 20:52:11.857195 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 20:52:11.865131 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 20:52:11.866747 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 20:52:11.868978 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 20:52:11.870391 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 20:52:11.921839 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 20:52:11.923369 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 20:52:11.924427 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 20:52:11.925639 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 20:52:12.098167 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:52:12.108762 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2022-06-19 20:52:12.111667 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2022-06-19 20:52:12.164535 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:52:12.166020 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:52:12.167418 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:52:12.168936 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:52:12.181807 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a96c5cad-3dfd-4b3f-8bea-e2a1d52f004f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcc1080>]}
2022-06-19 20:52:12.185409 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a96c5cad-3dfd-4b3f-8bea-e2a1d52f004f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fccde10>]}
2022-06-19 20:52:12.185657 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 20:52:12.186327 (MainThread): 
2022-06-19 20:52:12.186633 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:52:12.187372 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 20:52:12.187614 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 20:52:12.832487 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 20:52:12.833409 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 20:52:12.841774 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:52:13.220616 (MainThread): 16:52:13 | Concurrency: 1 threads (target='dev')
2022-06-19 20:52:13.221578 (MainThread): 16:52:13 | 
2022-06-19 20:52:13.224925 (Thread-1): Began running node model.jaffle_shop.customers
2022-06-19 20:52:13.225294 (Thread-1): 16:52:13 | 1 of 1 START view model dbt_agonzalez.customers...................... [RUN]
2022-06-19 20:52:13.225663 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:52:13.225848 (Thread-1): Compiling model.jaffle_shop.customers
2022-06-19 20:52:13.227910 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2022-06-19 20:52:13.228399 (Thread-1): finished collecting timing info
2022-06-19 20:52:13.246170 (Thread-1): finished collecting timing info
2022-06-19 20:52:13.246628 (Thread-1): Compilation Error in model customers (models/customers.sql)
  Trying to create view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`, but it currently exists as a table. Either drop `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model customers (models/customers.sql)
Traceback (most recent call last):
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 40, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/exceptions.py", line 1029, in inner
    raise exc
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/exceptions.py", line 1026, in inner
    return func(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/exceptions.py", line 698, in relation_wrong_type
    model)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/exceptions.py", line 447, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models/customers.sql)
  Trying to create view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`, but it currently exists as a table. Either drop `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model customers (models/customers.sql)
2022-06-19 20:52:13.249678 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a96c5cad-3dfd-4b3f-8bea-e2a1d52f004f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc30748>]}
2022-06-19 20:52:13.250113 (Thread-1): 16:52:13 | 1 of 1 ERROR creating view model dbt_agonzalez.customers............. [ERROR in 0.02s]
2022-06-19 20:52:13.250320 (Thread-1): Finished running node model.jaffle_shop.customers
2022-06-19 20:52:13.329992 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:52:13.330374 (MainThread): 16:52:13 | 
2022-06-19 20:52:13.330553 (MainThread): 16:52:13 | Finished running 1 view model in 1.14s.
2022-06-19 20:52:13.330724 (MainThread): Connection 'master' was properly closed.
2022-06-19 20:52:13.330877 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2022-06-19 20:52:13.334551 (MainThread): 
2022-06-19 20:52:13.334745 (MainThread): Completed with 1 error and 0 warnings:
2022-06-19 20:52:13.334955 (MainThread): 
2022-06-19 20:52:13.335187 (MainThread): Compilation Error in model customers (models/customers.sql)
2022-06-19 20:52:13.335384 (MainThread):   Trying to create view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`, but it currently exists as a table. Either drop `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2022-06-19 20:52:13.335553 (MainThread):   
2022-06-19 20:52:13.335742 (MainThread):   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
2022-06-19 20:52:13.335899 (MainThread):   > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
2022-06-19 20:52:13.336056 (MainThread):   > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
2022-06-19 20:52:13.336212 (MainThread):   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
2022-06-19 20:52:13.336365 (MainThread):   > called by model customers (models/customers.sql)
2022-06-19 20:52:13.336525 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-06-19 20:52:13.336748 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d1ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d1ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd1ac88>]}
2022-06-19 20:52:13.336989 (MainThread): Flushing usage events
2022-06-19 20:52:49.678456 (MainThread): Running with dbt=0.21.1
2022-06-19 20:52:49.922153 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customers'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 20:52:49.923264 (MainThread): Tracking: tracking
2022-06-19 20:52:49.936311 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107de630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107de7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107de9e8>]}
2022-06-19 20:52:49.947119 (MainThread): Partial parsing not enabled
2022-06-19 20:52:49.956595 (MainThread): Parsing macros/etc.sql
2022-06-19 20:52:49.959109 (MainThread): Parsing macros/catalog.sql
2022-06-19 20:52:49.965005 (MainThread): Parsing macros/adapters.sql
2022-06-19 20:52:49.985374 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 20:52:49.987683 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 20:52:49.989991 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 20:52:49.998661 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 20:52:50.001052 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 20:52:50.014671 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 20:52:50.016207 (MainThread): Parsing macros/core.sql
2022-06-19 20:52:50.019609 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 20:52:50.025720 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 20:52:50.034593 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 20:52:50.036089 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 20:52:50.051848 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 20:52:50.082816 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 20:52:50.103532 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 20:52:50.105104 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 20:52:50.114501 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 20:52:50.132979 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 20:52:50.145852 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 20:52:50.153454 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 20:52:50.160263 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 20:52:50.163728 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 20:52:50.165064 (MainThread): Parsing macros/etc/query.sql
2022-06-19 20:52:50.165926 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 20:52:50.167312 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 20:52:50.175166 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 20:52:50.176801 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 20:52:50.179042 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 20:52:50.180448 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 20:52:50.228752 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 20:52:50.230252 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 20:52:50.231295 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 20:52:50.232489 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 20:52:50.406242 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:52:50.417208 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2022-06-19 20:52:50.420207 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2022-06-19 20:52:50.474801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:52:50.476288 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:52:50.477681 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:52:50.479209 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:52:50.492067 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3654fe5c-599e-49b2-a1bd-a0b52ae134ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110801b00>]}
2022-06-19 20:52:50.495682 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3654fe5c-599e-49b2-a1bd-a0b52ae134ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11084e048>]}
2022-06-19 20:52:50.495921 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 20:52:50.496593 (MainThread): 
2022-06-19 20:52:50.496936 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:52:50.497713 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 20:52:50.497916 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 20:52:50.938223 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 20:52:50.939309 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 20:52:50.947874 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:52:51.409989 (MainThread): 16:52:51 | Concurrency: 1 threads (target='dev')
2022-06-19 20:52:51.411146 (MainThread): 16:52:51 | 
2022-06-19 20:52:51.414211 (Thread-1): Began running node model.jaffle_shop.customers
2022-06-19 20:52:51.414554 (Thread-1): 16:52:51 | 1 of 1 START view model dbt_agonzalez.customers...................... [RUN]
2022-06-19 20:52:51.414925 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:52:51.415115 (Thread-1): Compiling model.jaffle_shop.customers
2022-06-19 20:52:51.417181 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2022-06-19 20:52:51.417632 (Thread-1): finished collecting timing info
2022-06-19 20:52:51.435640 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:52:51.443415 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:52:51.876751 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2022-06-19 20:52:51.877316 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2022-06-19 20:52:52.861740 (Thread-1): finished collecting timing info
2022-06-19 20:52:52.862183 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3654fe5c-599e-49b2-a1bd-a0b52ae134ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108a2438>]}
2022-06-19 20:52:52.862590 (Thread-1): 16:52:52 | 1 of 1 OK created view model dbt_agonzalez.customers................. [OK in 1.45s]
2022-06-19 20:52:52.862786 (Thread-1): Finished running node model.jaffle_shop.customers
2022-06-19 20:52:52.880195 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:52:52.880521 (MainThread): 16:52:52 | 
2022-06-19 20:52:52.880698 (MainThread): 16:52:52 | Finished running 1 view model in 2.38s.
2022-06-19 20:52:52.880862 (MainThread): Connection 'master' was properly closed.
2022-06-19 20:52:52.881007 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2022-06-19 20:52:52.884845 (MainThread): 
2022-06-19 20:52:52.885035 (MainThread): Completed successfully
2022-06-19 20:52:52.885211 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-06-19 20:52:52.885489 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11084e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108a2438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108a7588>]}
2022-06-19 20:52:52.885706 (MainThread): Flushing usage events
2022-06-19 20:55:38.394691 (MainThread): Running with dbt=0.21.1
2022-06-19 20:55:38.641675 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 20:55:38.642852 (MainThread): Tracking: tracking
2022-06-19 20:55:38.657576 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e2898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e2588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e2be0>]}
2022-06-19 20:55:38.668213 (MainThread): Partial parsing not enabled
2022-06-19 20:55:38.677823 (MainThread): Parsing macros/etc.sql
2022-06-19 20:55:38.680331 (MainThread): Parsing macros/catalog.sql
2022-06-19 20:55:38.686799 (MainThread): Parsing macros/adapters.sql
2022-06-19 20:55:38.707720 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 20:55:38.710016 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 20:55:38.712358 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 20:55:38.721037 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 20:55:38.723409 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 20:55:38.736872 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 20:55:38.738339 (MainThread): Parsing macros/core.sql
2022-06-19 20:55:38.741648 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 20:55:38.747775 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 20:55:38.756681 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 20:55:38.758171 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 20:55:38.773907 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 20:55:38.807310 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 20:55:38.829091 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 20:55:38.830684 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 20:55:38.840434 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 20:55:38.859574 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 20:55:38.872729 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 20:55:38.880663 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 20:55:38.887778 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 20:55:38.891239 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 20:55:38.892564 (MainThread): Parsing macros/etc/query.sql
2022-06-19 20:55:38.893422 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 20:55:38.894805 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 20:55:38.902695 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 20:55:38.904315 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 20:55:38.906542 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 20:55:38.907953 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 20:55:38.958777 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 20:55:38.960304 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 20:55:38.961349 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 20:55:38.962552 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 20:55:39.138768 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:55:39.149481 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2022-06-19 20:55:39.152316 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2022-06-19 20:55:39.205209 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:55:39.206707 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:55:39.208123 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:55:39.209644 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 20:55:39.222730 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ad9a920-7b64-4ed8-8784-ef6a9497f93b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110876080>]}
2022-06-19 20:55:39.226411 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ad9a920-7b64-4ed8-8784-ef6a9497f93b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110884a20>]}
2022-06-19 20:55:39.226655 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 20:55:39.227477 (MainThread): 
2022-06-19 20:55:39.227807 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:55:39.228661 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 20:55:39.228906 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 20:55:39.709166 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 20:55:39.710148 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 20:55:39.718318 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:55:40.062429 (MainThread): 16:55:40 | Concurrency: 1 threads (target='dev')
2022-06-19 20:55:40.063549 (MainThread): 16:55:40 | 
2022-06-19 20:55:40.066631 (Thread-1): Began running node model.jaffle_shop.customers
2022-06-19 20:55:40.066959 (Thread-1): 16:55:40 | 1 of 3 START view model dbt_agonzalez.customers...................... [RUN]
2022-06-19 20:55:40.067333 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:55:40.067517 (Thread-1): Compiling model.jaffle_shop.customers
2022-06-19 20:55:40.069540 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2022-06-19 20:55:40.069973 (Thread-1): finished collecting timing info
2022-06-19 20:55:40.093642 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2022-06-19 20:55:40.094219 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:55:40.101632 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2022-06-19 20:55:41.075424 (Thread-1): finished collecting timing info
2022-06-19 20:55:41.076015 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad9a920-7b64-4ed8-8784-ef6a9497f93b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107decf8>]}
2022-06-19 20:55:41.076389 (Thread-1): 16:55:41 | 1 of 3 OK created view model dbt_agonzalez.customers................. [OK in 1.01s]
2022-06-19 20:55:41.076589 (Thread-1): Finished running node model.jaffle_shop.customers
2022-06-19 20:55:41.076865 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2022-06-19 20:55:41.077222 (Thread-1): 16:55:41 | 2 of 3 START table model dbt_agonzalez.my_first_dbt_model............ [RUN]
2022-06-19 20:55:41.077552 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2022-06-19 20:55:41.077761 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2022-06-19 20:55:41.078512 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49965), raddr=('142.250.65.202', 443)>
2022-06-19 20:55:41.078819 (Thread-1): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49966), raddr=('142.251.40.202', 443)>
2022-06-19 20:55:41.080463 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2022-06-19 20:55:41.080882 (Thread-1): finished collecting timing info
2022-06-19 20:55:41.090623 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49961), raddr=('142.250.65.202', 443)>
2022-06-19 20:55:41.090878 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49962), raddr=('142.251.40.202', 443)>
2022-06-19 20:55:41.091085 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49963), raddr=('142.250.65.202', 443)>
2022-06-19 20:55:41.091343 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49964), raddr=('142.251.40.202', 443)>
2022-06-19 20:55:41.094572 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:55:41.102032 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:55:41.510408 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2022-06-19 20:55:41.510912 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2022-06-19 20:55:43.834558 (Thread-1): finished collecting timing info
2022-06-19 20:55:43.836323 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad9a920-7b64-4ed8-8784-ef6a9497f93b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109d27b8>]}
2022-06-19 20:55:43.837460 (Thread-1): 16:55:43 | 2 of 3 OK created table model dbt_agonzalez.my_first_dbt_model....... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.76s]
2022-06-19 20:55:43.837734 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2022-06-19 20:55:43.838279 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2022-06-19 20:55:43.838592 (Thread-1): 16:55:43 | 3 of 3 START table model dbt_agonzalez.my_second_dbt_model........... [RUN]
2022-06-19 20:55:43.838959 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2022-06-19 20:55:43.839191 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2022-06-19 20:55:43.841279 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2022-06-19 20:55:43.841716 (Thread-1): finished collecting timing info
2022-06-19 20:55:43.842866 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:55:43.850303 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:55:44.245092 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:55:44.412736 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2022-06-19 20:55:44.414173 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace table `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`my_second_dbt_model`
  
  
  OPTIONS()
  as (
    -- Use the `ref` function to select from other models

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`my_first_dbt_model`
where id = 1
  );
    
2022-06-19 20:55:46.799690 (Thread-1): finished collecting timing info
2022-06-19 20:55:46.801537 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad9a920-7b64-4ed8-8784-ef6a9497f93b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a8a240>]}
2022-06-19 20:55:46.802759 (Thread-1): 16:55:46 | 3 of 3 OK created table model dbt_agonzalez.my_second_dbt_model...... [CREATE TABLE (1.0 rows, 8.0 Bytes processed) in 2.96s]
2022-06-19 20:55:46.803096 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2022-06-19 20:55:46.814867 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:55:46.815203 (MainThread): 16:55:46 | 
2022-06-19 20:55:46.815375 (MainThread): 16:55:46 | Finished running 1 view model, 2 table models in 7.59s.
2022-06-19 20:55:46.815541 (MainThread): Connection 'master' was properly closed.
2022-06-19 20:55:46.815689 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2022-06-19 20:55:46.819877 (MainThread): 
2022-06-19 20:55:46.820065 (MainThread): Completed successfully
2022-06-19 20:55:46.820241 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-06-19 20:55:46.820519 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0c2860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110884668>]}
2022-06-19 20:55:46.820770 (MainThread): Flushing usage events
2022-06-19 20:57:26.143317 (MainThread): Running with dbt=0.21.1
2022-06-19 20:57:26.386434 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 20:57:26.387590 (MainThread): Tracking: tracking
2022-06-19 20:57:26.400081 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c96c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c96588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c96be0>]}
2022-06-19 20:57:26.410772 (MainThread): Partial parsing not enabled
2022-06-19 20:57:26.419545 (MainThread): Parsing macros/etc.sql
2022-06-19 20:57:26.422000 (MainThread): Parsing macros/catalog.sql
2022-06-19 20:57:26.427793 (MainThread): Parsing macros/adapters.sql
2022-06-19 20:57:26.448262 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 20:57:26.450598 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 20:57:26.452920 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 20:57:26.461692 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 20:57:26.464097 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 20:57:26.477386 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 20:57:26.478889 (MainThread): Parsing macros/core.sql
2022-06-19 20:57:26.482242 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 20:57:26.488324 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 20:57:26.497140 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 20:57:26.498629 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 20:57:26.514315 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 20:57:26.544590 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 20:57:26.565106 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 20:57:26.566682 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 20:57:26.576064 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 20:57:26.594167 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 20:57:26.606728 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 20:57:26.614153 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 20:57:26.620845 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 20:57:26.624285 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 20:57:26.625592 (MainThread): Parsing macros/etc/query.sql
2022-06-19 20:57:26.626441 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 20:57:26.627810 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 20:57:26.635475 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 20:57:26.637068 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 20:57:26.639250 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 20:57:26.640643 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 20:57:26.688894 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 20:57:26.690398 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 20:57:26.691444 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 20:57:26.692634 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 20:57:26.867143 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:57:26.924579 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1960b6cc-768e-4e12-949c-5f71ede6b5b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a4828>]}
2022-06-19 20:57:26.927772 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1960b6cc-768e-4e12-949c-5f71ede6b5b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105abf28>]}
2022-06-19 20:57:26.928012 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 20:57:26.928618 (MainThread): 
2022-06-19 20:57:26.928933 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:57:26.929705 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 20:57:26.930001 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 20:57:27.356410 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 20:57:27.357536 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 20:57:27.366187 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 20:57:27.693072 (MainThread): 16:57:27 | Concurrency: 1 threads (target='dev')
2022-06-19 20:57:27.694078 (MainThread): 16:57:27 | 
2022-06-19 20:57:27.696340 (Thread-1): Began running node model.jaffle_shop.customers
2022-06-19 20:57:27.696672 (Thread-1): 16:57:27 | 1 of 1 START view model dbt_agonzalez.customers...................... [RUN]
2022-06-19 20:57:27.697050 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 20:57:27.697240 (Thread-1): Compiling model.jaffle_shop.customers
2022-06-19 20:57:27.699333 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2022-06-19 20:57:27.699777 (Thread-1): finished collecting timing info
2022-06-19 20:57:27.700457 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49979), raddr=('142.250.65.202', 443)>
2022-06-19 20:57:27.700730 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49980), raddr=('142.251.40.202', 443)>
2022-06-19 20:57:27.700943 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49981), raddr=('142.250.65.202', 443)>
2022-06-19 20:57:27.701133 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49982), raddr=('142.251.40.202', 443)>
2022-06-19 20:57:27.724336 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2022-06-19 20:57:27.724994 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 20:57:27.732726 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2022-06-19 20:57:28.985728 (Thread-1): finished collecting timing info
2022-06-19 20:57:28.986225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1960b6cc-768e-4e12-949c-5f71ede6b5b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e412e8>]}
2022-06-19 20:57:28.986603 (Thread-1): 16:57:28 | 1 of 1 OK created view model dbt_agonzalez.customers................. [OK in 1.29s]
2022-06-19 20:57:28.986798 (Thread-1): Finished running node model.jaffle_shop.customers
2022-06-19 20:57:29.034790 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 20:57:29.035167 (MainThread): 16:57:29 | 
2022-06-19 20:57:29.035356 (MainThread): 16:57:29 | Finished running 1 view model in 2.11s.
2022-06-19 20:57:29.035527 (MainThread): Connection 'master' was properly closed.
2022-06-19 20:57:29.035725 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2022-06-19 20:57:29.036503 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49983), raddr=('142.250.65.202', 443)>
2022-06-19 20:57:29.036794 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 49984), raddr=('142.251.40.202', 443)>
2022-06-19 20:57:29.040023 (MainThread): 
2022-06-19 20:57:29.040232 (MainThread): Completed successfully
2022-06-19 20:57:29.040409 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-06-19 20:57:29.040635 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ab358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e33358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e33320>]}
2022-06-19 20:57:29.040864 (MainThread): Flushing usage events
2022-06-19 21:04:16.476947 (MainThread): Running with dbt=0.21.1
2022-06-19 21:04:16.721395 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 21:04:16.722467 (MainThread): Tracking: tracking
2022-06-19 21:04:16.735129 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11216f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11216f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11216fcc0>]}
2022-06-19 21:04:16.745897 (MainThread): Partial parsing not enabled
2022-06-19 21:04:16.754794 (MainThread): Parsing macros/etc.sql
2022-06-19 21:04:16.757256 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:04:16.763056 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:04:16.783079 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:04:16.785340 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:04:16.787613 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:04:16.796330 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:04:16.798760 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:04:16.812176 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:04:16.813647 (MainThread): Parsing macros/core.sql
2022-06-19 21:04:16.816949 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:04:16.822954 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:04:16.831690 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:04:16.833160 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:04:16.848582 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:04:16.878747 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:04:16.899137 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:04:16.900683 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:04:16.910014 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:04:16.928250 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:04:16.941076 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:04:16.948502 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:04:16.955189 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:04:16.958559 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:04:16.959852 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:04:16.960689 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:04:16.962040 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:04:16.969679 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:04:16.971301 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:04:16.973570 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:04:16.974991 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:04:17.023039 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:04:17.024530 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:04:17.025572 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:04:17.026747 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:04:17.197244 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:04:17.207112 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:04:17.210426 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:04:17.259579 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14944402-e820-4fbc-91f7-1c78754c2452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea77fd0>]}
2022-06-19 21:04:17.262832 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14944402-e820-4fbc-91f7-1c78754c2452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112277eb8>]}
2022-06-19 21:04:17.263081 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:04:17.263750 (MainThread): 
2022-06-19 21:04:17.264047 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:04:17.264868 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 21:04:17.265064 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 21:04:17.763478 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 21:04:17.764489 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 21:04:17.772928 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:04:18.143509 (MainThread): 17:04:18 | Concurrency: 1 threads (target='dev')
2022-06-19 21:04:18.144468 (MainThread): 17:04:18 | 
2022-06-19 21:04:18.146938 (Thread-1): Began running node model.jaffle_shop.stg_customers
2022-06-19 21:04:18.147320 (Thread-1): 17:04:18 | 1 of 3 START table model dbt_agonzalez.stg_customers................. [RUN]
2022-06-19 21:04:18.147737 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:04:18.147924 (Thread-1): Compiling model.jaffle_shop.stg_customers
2022-06-19 21:04:18.148690 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50012), raddr=('142.250.65.234', 443)>
2022-06-19 21:04:18.148978 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50013), raddr=('142.250.80.42', 443)>
2022-06-19 21:04:18.149189 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50014), raddr=('142.250.65.234', 443)>
2022-06-19 21:04:18.149378 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50015), raddr=('142.250.80.42', 443)>
2022-06-19 21:04:18.150450 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2022-06-19 21:04:18.150932 (Thread-1): finished collecting timing info
2022-06-19 21:04:18.184012 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2022-06-19 21:04:18.184530 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:04:18.192078 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2022-06-19 21:04:20.865591 (Thread-1): finished collecting timing info
2022-06-19 21:04:20.866122 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14944402-e820-4fbc-91f7-1c78754c2452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112324908>]}
2022-06-19 21:04:20.866458 (Thread-1): 17:04:20 | 1 of 3 OK created table model dbt_agonzalez.stg_customers............ [CREATE TABLE (100.0 rows, 1.9 KB processed) in 2.72s]
2022-06-19 21:04:20.866645 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2022-06-19 21:04:20.866881 (Thread-1): Began running node model.jaffle_shop.stg_orders
2022-06-19 21:04:20.867227 (Thread-1): 17:04:20 | 2 of 3 START table model dbt_agonzalez.stg_orders.................... [RUN]
2022-06-19 21:04:20.867544 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:04:20.867770 (Thread-1): Compiling model.jaffle_shop.stg_orders
2022-06-19 21:04:20.868961 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2022-06-19 21:04:20.869413 (Thread-1): finished collecting timing info
2022-06-19 21:04:20.871149 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2022-06-19 21:04:20.871486 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:04:20.878912 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2022-06-19 21:04:23.538137 (Thread-1): finished collecting timing info
2022-06-19 21:04:23.539821 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14944402-e820-4fbc-91f7-1c78754c2452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11234e2e8>]}
2022-06-19 21:04:23.540959 (Thread-1): 17:04:23 | 2 of 3 OK created table model dbt_agonzalez.stg_orders............... [CREATE TABLE (99.0 rows, 3.3 KB processed) in 2.67s]
2022-06-19 21:04:23.541418 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2022-06-19 21:04:23.541883 (Thread-1): Began running node model.jaffle_shop.customers
2022-06-19 21:04:23.542249 (Thread-1): 17:04:23 | 3 of 3 START view model dbt_agonzalez.customers...................... [RUN]
2022-06-19 21:04:23.542643 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:04:23.542842 (Thread-1): Compiling model.jaffle_shop.customers
2022-06-19 21:04:23.545431 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2022-06-19 21:04:23.545874 (Thread-1): finished collecting timing info
2022-06-19 21:04:23.559138 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2022-06-19 21:04:23.559515 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:04:23.567532 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
  OPTIONS()
  as 

with customers as (

    select * from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`

),

orders as (

    select * from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2022-06-19 21:04:24.549950 (Thread-1): finished collecting timing info
2022-06-19 21:04:24.550520 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14944402-e820-4fbc-91f7-1c78754c2452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121fe630>]}
2022-06-19 21:04:24.550858 (Thread-1): 17:04:24 | 3 of 3 OK created view model dbt_agonzalez.customers................. [OK in 1.01s]
2022-06-19 21:04:24.551057 (Thread-1): Finished running node model.jaffle_shop.customers
2022-06-19 21:04:24.562729 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:04:24.563092 (MainThread): 17:04:24 | 
2022-06-19 21:04:24.563276 (MainThread): 17:04:24 | Finished running 2 table models, 1 view model in 7.30s.
2022-06-19 21:04:24.563445 (MainThread): Connection 'master' was properly closed.
2022-06-19 21:04:24.563689 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2022-06-19 21:04:24.564378 (MainThread): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50020), raddr=('142.250.65.234', 443)>
2022-06-19 21:04:24.564638 (MainThread): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50021), raddr=('142.250.80.42', 443)>
2022-06-19 21:04:24.567845 (MainThread): 
2022-06-19 21:04:24.568044 (MainThread): Completed successfully
2022-06-19 21:04:24.568222 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-06-19 21:04:24.568444 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112216f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112359da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11174e898>]}
2022-06-19 21:04:24.568667 (MainThread): Flushing usage events
2022-06-19 21:06:22.214210 (MainThread): Running with dbt=0.21.1
2022-06-19 21:06:22.530762 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 21:06:22.532281 (MainThread): Tracking: tracking
2022-06-19 21:06:22.552726 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027dc18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027d588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027dbe0>]}
2022-06-19 21:06:22.564403 (MainThread): Partial parsing not enabled
2022-06-19 21:06:22.575209 (MainThread): Parsing macros/etc.sql
2022-06-19 21:06:22.577965 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:06:22.583857 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:06:22.603721 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:06:22.605932 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:06:22.608196 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:06:22.616712 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:06:22.619065 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:06:22.632437 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:06:22.633878 (MainThread): Parsing macros/core.sql
2022-06-19 21:06:22.637146 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:06:22.643107 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:06:22.651778 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:06:22.653255 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:06:22.668905 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:06:22.699683 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:06:22.720488 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:06:22.722065 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:06:22.731435 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:06:22.749518 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:06:22.762070 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:06:22.769506 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:06:22.776189 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:06:22.779590 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:06:22.780887 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:06:22.781728 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:06:22.783093 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:06:22.790729 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:06:22.792316 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:06:22.794523 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:06:22.795927 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:06:22.844533 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:06:22.846034 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:06:22.847080 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:06:22.848263 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:06:23.020656 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:06:23.030640 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:06:23.034000 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:06:23.084032 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd80aaa24-b5df-4f7c-8469-1a05fd677f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110383a58>]}
2022-06-19 21:06:23.087357 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd80aaa24-b5df-4f7c-8469-1a05fd677f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb84b70>]}
2022-06-19 21:06:23.087602 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:06:23.088279 (MainThread): 
2022-06-19 21:06:23.088592 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:06:23.089466 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 21:06:23.089728 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 21:06:23.556928 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 21:06:23.557955 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 21:06:23.566599 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:06:23.965711 (MainThread): 17:06:23 | Concurrency: 1 threads (target='dev')
2022-06-19 21:06:23.966660 (MainThread): 17:06:23 | 
2022-06-19 21:06:23.969639 (Thread-1): Began running node model.jaffle_shop.stg_customers
2022-06-19 21:06:23.969986 (Thread-1): 17:06:23 | 1 of 3 START table model dbt_agonzalez.stg_customers................. [RUN]
2022-06-19 21:06:23.970418 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:06:23.970610 (Thread-1): Compiling model.jaffle_shop.stg_customers
2022-06-19 21:06:23.971329 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50055), raddr=('142.250.80.74', 443)>
2022-06-19 21:06:23.971615 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50056), raddr=('142.250.80.42', 443)>
2022-06-19 21:06:23.971827 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50057), raddr=('142.250.80.74', 443)>
2022-06-19 21:06:23.972019 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50058), raddr=('142.250.80.42', 443)>
2022-06-19 21:06:23.973151 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2022-06-19 21:06:23.973596 (Thread-1): finished collecting timing info
2022-06-19 21:06:23.990521 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:06:23.998514 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:06:24.415277 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2022-06-19 21:06:24.415794 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2022-06-19 21:06:26.664093 (Thread-1): finished collecting timing info
2022-06-19 21:06:26.664607 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd80aaa24-b5df-4f7c-8469-1a05fd677f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11042b080>]}
2022-06-19 21:06:26.664966 (Thread-1): 17:06:26 | 1 of 3 OK created table model dbt_agonzalez.stg_customers............ [CREATE TABLE (100.0 rows, 1.9 KB processed) in 2.69s]
2022-06-19 21:06:26.665171 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2022-06-19 21:06:26.665389 (Thread-1): Began running node model.jaffle_shop.stg_orders
2022-06-19 21:06:26.665659 (Thread-1): 17:06:26 | 2 of 3 START table model dbt_agonzalez.stg_orders.................... [RUN]
2022-06-19 21:06:26.666121 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:06:26.666330 (Thread-1): Compiling model.jaffle_shop.stg_orders
2022-06-19 21:06:26.667498 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2022-06-19 21:06:26.667932 (Thread-1): finished collecting timing info
2022-06-19 21:06:26.669181 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:06:26.676510 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:06:27.042680 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2022-06-19 21:06:27.044521 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2022-06-19 21:06:29.432184 (Thread-1): finished collecting timing info
2022-06-19 21:06:29.433962 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd80aaa24-b5df-4f7c-8469-1a05fd677f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104564a8>]}
2022-06-19 21:06:29.435077 (Thread-1): 17:06:29 | 2 of 3 OK created table model dbt_agonzalez.stg_orders............... [CREATE TABLE (99.0 rows, 3.3 KB processed) in 2.77s]
2022-06-19 21:06:29.435617 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2022-06-19 21:06:29.436073 (Thread-1): Began running node model.jaffle_shop.customers
2022-06-19 21:06:29.436373 (Thread-1): 17:06:29 | 3 of 3 START view model dbt_agonzalez.customers...................... [RUN]
2022-06-19 21:06:29.436734 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:06:29.436975 (Thread-1): Compiling model.jaffle_shop.customers
2022-06-19 21:06:29.439729 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2022-06-19 21:06:29.440166 (Thread-1): finished collecting timing info
2022-06-19 21:06:29.453800 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2022-06-19 21:06:29.454461 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:06:29.462196 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
  OPTIONS()
  as 

with customers as (

    select * from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`

),

orders as (

    select * from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders


),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2022-06-19 21:06:30.245825 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column customer_id which is neither grouped nor aggregated at [23:9]',)
2022-06-19 21:06:31.450134 (Thread-1): finished collecting timing info
2022-06-19 21:06:31.451799 (Thread-1): Database Error in model customers (models/customers.sql)
  SELECT list expression references column customer_id which is neither grouped nor aggregated at [23:9]
  compiled SQL at target/run/jaffle_shop/models/customers.sql
Traceback (most recent call last):
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1498, in result
    do_get_result()
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/google/api_core/retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1488, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 728, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 SELECT list expression references column customer_id which is neither grouped nor aggregated at [23:9]

Location: US
Job ID: 99199cf5-7a7d-4de9-b73b-b33f8a2510a9


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/Users/agonzalez/.pyenv/versions/3.6.12/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  SELECT list expression references column customer_id which is neither grouped nor aggregated at [23:9]
  compiled SQL at target/run/jaffle_shop/models/customers.sql
2022-06-19 21:06:31.457876 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd80aaa24-b5df-4f7c-8469-1a05fd677f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb84e10>]}
2022-06-19 21:06:31.458326 (Thread-1): 17:06:31 | 3 of 3 ERROR creating view model dbt_agonzalez.customers............. [ERROR in 2.02s]
2022-06-19 21:06:31.458553 (Thread-1): Finished running node model.jaffle_shop.customers
2022-06-19 21:06:31.533563 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:06:31.533967 (MainThread): 17:06:31 | 
2022-06-19 21:06:31.534153 (MainThread): 17:06:31 | Finished running 2 table models, 1 view model in 8.45s.
2022-06-19 21:06:31.534322 (MainThread): Connection 'master' was properly closed.
2022-06-19 21:06:31.534471 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2022-06-19 21:06:31.538171 (MainThread): 
2022-06-19 21:06:31.538362 (MainThread): Completed with 1 error and 0 warnings:
2022-06-19 21:06:31.538530 (MainThread): 
2022-06-19 21:06:31.538694 (MainThread): Database Error in model customers (models/customers.sql)
2022-06-19 21:06:31.538851 (MainThread):   SELECT list expression references column customer_id which is neither grouped nor aggregated at [23:9]
2022-06-19 21:06:31.539005 (MainThread):   compiled SQL at target/run/jaffle_shop/models/customers.sql
2022-06-19 21:06:31.539166 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-06-19 21:06:31.539389 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4137f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11049d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103839b0>]}
2022-06-19 21:06:31.539656 (MainThread): Flushing usage events
2022-06-19 21:09:36.890497 (MainThread): Running with dbt=0.21.1
2022-06-19 21:09:37.134221 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['stg_customers,stg_orders'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 21:09:37.135501 (MainThread): Tracking: tracking
2022-06-19 21:09:37.148026 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109cb780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109cb828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109cb7f0>]}
2022-06-19 21:09:37.158995 (MainThread): Partial parsing not enabled
2022-06-19 21:09:37.168373 (MainThread): Parsing macros/etc.sql
2022-06-19 21:09:37.170853 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:09:37.176685 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:09:37.197168 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:09:37.199496 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:09:37.201833 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:09:37.210491 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:09:37.212889 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:09:37.226253 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:09:37.227724 (MainThread): Parsing macros/core.sql
2022-06-19 21:09:37.231030 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:09:37.237059 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:09:37.245874 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:09:37.247355 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:09:37.262920 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:09:37.293114 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:09:37.313555 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:09:37.315124 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:09:37.324440 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:09:37.342433 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:09:37.354981 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:09:37.362348 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:09:37.368994 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:09:37.372451 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:09:37.373771 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:09:37.374636 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:09:37.376017 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:09:37.383740 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:09:37.385384 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:09:37.387595 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:09:37.389015 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:09:37.437308 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:09:37.438806 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:09:37.439846 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:09:37.441040 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:09:37.611959 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:09:37.622945 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:09:37.625236 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:09:37.674240 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '696a5f1d-d2d3-47d2-be83-50fd39bdaf6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab4a90>]}
2022-06-19 21:09:37.677587 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '696a5f1d-d2d3-47d2-be83-50fd39bdaf6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab4a58>]}
2022-06-19 21:09:37.677821 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:09:37.678220 (MainThread): The selection criterion 'stg_customers,stg_orders' does not match any nodes
2022-06-19 21:09:37.678549 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2022-06-19 21:09:37.681903 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de1588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0cbac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0cba58>]}
2022-06-19 21:09:37.682126 (MainThread): Flushing usage events
2022-06-19 21:09:37.883664 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2022-06-19 21:09:47.980454 (MainThread): Running with dbt=0.21.1
2022-06-19 21:09:48.224820 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['stg_customers'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 21:09:48.226017 (MainThread): Tracking: tracking
2022-06-19 21:09:48.238031 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114003cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114003828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140037b8>]}
2022-06-19 21:09:48.248851 (MainThread): Partial parsing not enabled
2022-06-19 21:09:48.258049 (MainThread): Parsing macros/etc.sql
2022-06-19 21:09:48.260552 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:09:48.266417 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:09:48.286587 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:09:48.288904 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:09:48.291224 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:09:48.299941 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:09:48.302343 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:09:48.315823 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:09:48.317291 (MainThread): Parsing macros/core.sql
2022-06-19 21:09:48.320620 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:09:48.326699 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:09:48.335540 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:09:48.337024 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:09:48.352732 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:09:48.383659 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:09:48.404636 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:09:48.406270 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:09:48.415856 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:09:48.434365 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:09:48.447204 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:09:48.454793 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:09:48.461611 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:09:48.465073 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:09:48.466403 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:09:48.467262 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:09:48.468644 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:09:48.476452 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:09:48.478080 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:09:48.480294 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:09:48.481704 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:09:48.530630 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:09:48.532131 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:09:48.533183 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:09:48.534379 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:09:48.709172 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:09:48.720505 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:09:48.722802 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:09:48.771837 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ddec7fd-eb1f-498f-a138-e5e55d999ae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11410ad68>]}
2022-06-19 21:09:48.775367 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ddec7fd-eb1f-498f-a138-e5e55d999ae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11410e048>]}
2022-06-19 21:09:48.775617 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:09:48.776216 (MainThread): 
2022-06-19 21:09:48.776531 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:09:48.777261 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 21:09:48.777513 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 21:09:49.190791 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 21:09:49.191711 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 21:09:49.200401 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:09:49.201205 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50077), raddr=('142.250.65.202', 443)>
2022-06-19 21:09:49.201457 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50078), raddr=('142.250.80.42', 443)>
2022-06-19 21:09:49.558944 (MainThread): 17:09:49 | Concurrency: 1 threads (target='dev')
2022-06-19 21:09:49.560001 (MainThread): 17:09:49 | 
2022-06-19 21:09:49.563101 (Thread-1): Began running node model.jaffle_shop.stg_customers
2022-06-19 21:09:49.563467 (Thread-1): 17:09:49 | 1 of 1 START view model dbt_agonzalez.stg_customers.................. [RUN]
2022-06-19 21:09:49.563852 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:09:49.564057 (Thread-1): Compiling model.jaffle_shop.stg_customers
2022-06-19 21:09:49.565195 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2022-06-19 21:09:49.565722 (Thread-1): finished collecting timing info
2022-06-19 21:09:49.583680 (Thread-1): finished collecting timing info
2022-06-19 21:09:49.584113 (Thread-1): Compilation Error in model stg_customers (models/staging/stg_customers.sql)
  Trying to create view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`, but it currently exists as a table. Either drop `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model stg_customers (models/staging/stg_customers.sql)
Traceback (most recent call last):
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 40, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/exceptions.py", line 1029, in inner
    raise exc
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/exceptions.py", line 1026, in inner
    return func(*args, **kwargs)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/exceptions.py", line 698, in relation_wrong_type
    model)
  File "/Users/agonzalez/.virtualenvs/dbt/lib/python3.6/site-packages/dbt/exceptions.py", line 447, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_customers (models/staging/stg_customers.sql)
  Trying to create view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`, but it currently exists as a table. Either drop `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model stg_customers (models/staging/stg_customers.sql)
2022-06-19 21:09:49.585896 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ddec7fd-eb1f-498f-a138-e5e55d999ae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140a9978>]}
2022-06-19 21:09:49.586278 (Thread-1): 17:09:49 | 1 of 1 ERROR creating view model dbt_agonzalez.stg_customers......... [ERROR in 0.02s]
2022-06-19 21:09:49.586479 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2022-06-19 21:09:49.668069 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:09:49.668456 (MainThread): 17:09:49 | 
2022-06-19 21:09:49.668641 (MainThread): 17:09:49 | Finished running 1 view model in 0.89s.
2022-06-19 21:09:49.668812 (MainThread): Connection 'master' was properly closed.
2022-06-19 21:09:49.668963 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2022-06-19 21:09:49.672677 (MainThread): 
2022-06-19 21:09:49.672921 (MainThread): Completed with 1 error and 0 warnings:
2022-06-19 21:09:49.673132 (MainThread): 
2022-06-19 21:09:49.673332 (MainThread): Compilation Error in model stg_customers (models/staging/stg_customers.sql)
2022-06-19 21:09:49.673578 (MainThread):   Trying to create view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`, but it currently exists as a table. Either drop `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2022-06-19 21:09:49.673754 (MainThread):   
2022-06-19 21:09:49.673918 (MainThread):   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
2022-06-19 21:09:49.674101 (MainThread):   > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
2022-06-19 21:09:49.674266 (MainThread):   > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
2022-06-19 21:09:49.674451 (MainThread):   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
2022-06-19 21:09:49.674615 (MainThread):   > called by model stg_customers (models/staging/stg_customers.sql)
2022-06-19 21:09:49.674789 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-06-19 21:09:49.675008 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140ac128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140af4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140afac8>]}
2022-06-19 21:09:49.675230 (MainThread): Flushing usage events
2022-06-19 21:10:54.438069 (MainThread): Running with dbt=0.21.1
2022-06-19 21:10:54.681485 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['stg_customers', 'stg_orders'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 21:10:54.682639 (MainThread): Tracking: tracking
2022-06-19 21:10:54.695836 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114227748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114227630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114227a20>]}
2022-06-19 21:10:54.706531 (MainThread): Partial parsing not enabled
2022-06-19 21:10:54.715877 (MainThread): Parsing macros/etc.sql
2022-06-19 21:10:54.718378 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:10:54.724623 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:10:54.745530 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:10:54.747848 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:10:54.750188 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:10:54.759013 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:10:54.761434 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:10:54.775088 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:10:54.776578 (MainThread): Parsing macros/core.sql
2022-06-19 21:10:54.779951 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:10:54.786121 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:10:54.795117 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:10:54.796632 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:10:54.812554 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:10:54.844345 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:10:54.865756 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:10:54.867375 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:10:54.877064 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:10:54.896008 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:10:54.909181 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:10:54.916857 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:10:54.923790 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:10:54.927285 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:10:54.928622 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:10:54.929485 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:10:54.930887 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:10:54.938842 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:10:54.940481 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:10:54.942743 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:10:54.944177 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:10:54.994102 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:10:54.995627 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:10:54.996665 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:10:54.997847 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:10:55.172033 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:10:55.183173 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:10:55.185436 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:10:55.235139 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba6e937-b664-4300-9587-a3c6b36ef887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11430c320>]}
2022-06-19 21:10:55.238376 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ba6e937-b664-4300-9587-a3c6b36ef887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142eee48>]}
2022-06-19 21:10:55.238624 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:10:55.239306 (MainThread): 
2022-06-19 21:10:55.239618 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:10:55.240443 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 21:10:55.240709 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 21:10:55.749182 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 21:10:55.750092 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 21:10:55.757990 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:10:55.758757 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50091), raddr=('172.217.165.138', 443)>
2022-06-19 21:10:55.759017 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50092), raddr=('142.251.40.234', 443)>
2022-06-19 21:10:56.125013 (MainThread): 17:10:56 | Concurrency: 1 threads (target='dev')
2022-06-19 21:10:56.125735 (MainThread): 17:10:56 | 
2022-06-19 21:10:56.128289 (Thread-1): Began running node model.jaffle_shop.stg_customers
2022-06-19 21:10:56.128671 (Thread-1): 17:10:56 | 1 of 2 START view model dbt_agonzalez.stg_customers.................. [RUN]
2022-06-19 21:10:56.129047 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:10:56.129235 (Thread-1): Compiling model.jaffle_shop.stg_customers
2022-06-19 21:10:56.130362 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2022-06-19 21:10:56.130830 (Thread-1): finished collecting timing info
2022-06-19 21:10:56.148387 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:10:56.156138 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:10:56.578159 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2022-06-19 21:10:56.578768 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2022-06-19 21:10:57.561495 (Thread-1): finished collecting timing info
2022-06-19 21:10:57.561953 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ba6e937-b664-4300-9587-a3c6b36ef887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143fbeb8>]}
2022-06-19 21:10:57.562331 (Thread-1): 17:10:57 | 1 of 2 OK created view model dbt_agonzalez.stg_customers............. [OK in 1.43s]
2022-06-19 21:10:57.562536 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2022-06-19 21:10:57.562820 (Thread-1): Began running node model.jaffle_shop.stg_orders
2022-06-19 21:10:57.563179 (Thread-1): 17:10:57 | 2 of 2 START view model dbt_agonzalez.stg_orders..................... [RUN]
2022-06-19 21:10:57.563538 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:10:57.563755 (Thread-1): Compiling model.jaffle_shop.stg_orders
2022-06-19 21:10:57.564912 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2022-06-19 21:10:57.565387 (Thread-1): finished collecting timing info
2022-06-19 21:10:57.566820 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:10:57.574191 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:10:57.974394 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2022-06-19 21:10:57.975911 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2022-06-19 21:10:59.004993 (Thread-1): finished collecting timing info
2022-06-19 21:10:59.005624 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ba6e937-b664-4300-9587-a3c6b36ef887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11444c748>]}
2022-06-19 21:10:59.005960 (Thread-1): 17:10:59 | 2 of 2 OK created view model dbt_agonzalez.stg_orders................ [OK in 1.44s]
2022-06-19 21:10:59.006156 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2022-06-19 21:10:59.022250 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:10:59.022649 (MainThread): 17:10:59 | 
2022-06-19 21:10:59.022843 (MainThread): 17:10:59 | Finished running 2 view models in 3.78s.
2022-06-19 21:10:59.023089 (MainThread): Connection 'master' was properly closed.
2022-06-19 21:10:59.023241 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2022-06-19 21:10:59.026797 (MainThread): 
2022-06-19 21:10:59.026990 (MainThread): Completed successfully
2022-06-19 21:10:59.027167 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-06-19 21:10:59.027383 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11444c748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142eed68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142ee7f0>]}
2022-06-19 21:10:59.027609 (MainThread): Flushing usage events
2022-06-19 21:11:47.369555 (MainThread): Running with dbt=0.21.1
2022-06-19 21:11:47.671027 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['stg_customers', 'models/staging'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-19 21:11:47.672582 (MainThread): Tracking: tracking
2022-06-19 21:11:47.687034 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114aeb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114aeb7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114aebcf8>]}
2022-06-19 21:11:47.698654 (MainThread): Partial parsing not enabled
2022-06-19 21:11:47.709637 (MainThread): Parsing macros/etc.sql
2022-06-19 21:11:47.712322 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:11:47.718194 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:11:47.738362 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:11:47.740621 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:11:47.742897 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:11:47.751440 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:11:47.753794 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:11:47.767285 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:11:47.768754 (MainThread): Parsing macros/core.sql
2022-06-19 21:11:47.772105 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:11:47.778175 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:11:47.787011 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:11:47.788493 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:11:47.804129 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:11:47.834766 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:11:47.855339 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:11:47.856914 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:11:47.866325 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:11:47.884460 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:11:47.897083 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:11:47.904643 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:11:47.911485 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:11:47.914953 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:11:47.916283 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:11:47.917139 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:11:47.918534 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:11:47.926375 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:11:47.928000 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:11:47.930236 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:11:47.931656 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:11:47.980435 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:11:47.981945 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:11:47.983000 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:11:47.984189 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:11:48.158466 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:11:48.169681 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:11:48.172003 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:11:48.221459 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b858d7f-f4ea-45d1-b32f-1cc97aadf5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114be6780>]}
2022-06-19 21:11:48.225891 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b858d7f-f4ea-45d1-b32f-1cc97aadf5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114be6780>]}
2022-06-19 21:11:48.226144 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:11:48.227030 (MainThread): 
2022-06-19 21:11:48.227345 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:11:48.228192 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial".
2022-06-19 21:11:48.228461 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 21:11:48.681018 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 21:11:48.682130 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-06-19 21:11:48.691112 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50112), raddr=('172.217.165.138', 443)>
2022-06-19 21:11:48.691427 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50113), raddr=('142.251.40.234', 443)>
2022-06-19 21:11:48.691760 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:11:49.085989 (MainThread): 17:11:49 | Concurrency: 1 threads (target='dev')
2022-06-19 21:11:49.086869 (MainThread): 17:11:49 | 
2022-06-19 21:11:49.090089 (Thread-1): Began running node model.jaffle_shop.stg_customers
2022-06-19 21:11:49.090441 (Thread-1): 17:11:49 | 1 of 2 START view model dbt_agonzalez.stg_customers.................. [RUN]
2022-06-19 21:11:49.090818 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:11:49.091010 (Thread-1): Compiling model.jaffle_shop.stg_customers
2022-06-19 21:11:49.092206 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2022-06-19 21:11:49.092574 (Thread-1): finished collecting timing info
2022-06-19 21:11:49.116134 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2022-06-19 21:11:49.116627 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:11:49.124265 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2022-06-19 21:11:50.046039 (Thread-1): finished collecting timing info
2022-06-19 21:11:50.046555 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b858d7f-f4ea-45d1-b32f-1cc97aadf5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ccfc50>]}
2022-06-19 21:11:50.046955 (Thread-1): 17:11:50 | 1 of 2 OK created view model dbt_agonzalez.stg_customers............. [OK in 0.96s]
2022-06-19 21:11:50.047157 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2022-06-19 21:11:50.047401 (Thread-1): Began running node model.jaffle_shop.stg_orders
2022-06-19 21:11:50.047793 (Thread-1): 17:11:50 | 2 of 2 START view model dbt_agonzalez.stg_orders..................... [RUN]
2022-06-19 21:11:50.048185 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:11:50.048396 (Thread-1): Compiling model.jaffle_shop.stg_orders
2022-06-19 21:11:50.049085 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50116), raddr=('172.217.165.138', 443)>
2022-06-19 21:11:50.049387 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50117), raddr=('142.251.40.234', 443)>
2022-06-19 21:11:50.050251 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2022-06-19 21:11:50.050706 (Thread-1): finished collecting timing info
2022-06-19 21:11:50.052334 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2022-06-19 21:11:50.053523 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:11:50.060843 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2022-06-19 21:11:51.127865 (Thread-1): finished collecting timing info
2022-06-19 21:11:51.128620 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b858d7f-f4ea-45d1-b32f-1cc97aadf5f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d2a2e8>]}
2022-06-19 21:11:51.129026 (Thread-1): 17:11:51 | 2 of 2 OK created view model dbt_agonzalez.stg_orders................ [OK in 1.08s]
2022-06-19 21:11:51.129271 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2022-06-19 21:11:51.176822 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:11:51.177351 (MainThread): 17:11:51 | 
2022-06-19 21:11:51.177546 (MainThread): 17:11:51 | Finished running 2 view models in 2.95s.
2022-06-19 21:11:51.177723 (MainThread): Connection 'master' was properly closed.
2022-06-19 21:11:51.177878 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2022-06-19 21:11:51.181556 (MainThread): 
2022-06-19 21:11:51.181750 (MainThread): Completed successfully
2022-06-19 21:11:51.181927 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-06-19 21:11:51.182145 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d2a2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cbc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b80128>]}
2022-06-19 21:11:51.182367 (MainThread): Flushing usage events
2022-06-19 21:27:03.768028 (MainThread): Running with dbt=0.21.1
2022-06-19 21:27:04.016330 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-06-19 21:27:04.017441 (MainThread): Tracking: tracking
2022-06-19 21:27:04.030257 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114aab5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114aab860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114aaba90>]}
2022-06-19 21:27:04.041024 (MainThread): Partial parsing not enabled
2022-06-19 21:27:04.050614 (MainThread): Parsing macros/etc.sql
2022-06-19 21:27:04.053086 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:27:04.058896 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:27:04.078919 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:27:04.081168 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:27:04.083429 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:27:04.092051 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:27:04.094438 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:27:04.107881 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:27:04.109341 (MainThread): Parsing macros/core.sql
2022-06-19 21:27:04.112663 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:27:04.118695 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:27:04.127483 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:27:04.128961 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:27:04.144629 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:27:04.175085 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:27:04.195653 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:27:04.197223 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:27:04.206607 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:27:04.224705 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:27:04.237309 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:27:04.244755 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:27:04.251448 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:27:04.254829 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:27:04.256133 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:27:04.256975 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:27:04.258339 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:27:04.266013 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:27:04.267611 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:27:04.269796 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:27:04.271179 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:27:04.318943 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:27:04.320412 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:27:04.321430 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:27:04.322595 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:27:04.495392 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:27:04.506532 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:27:04.508814 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:27:04.562389 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.563885 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.565298 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.566821 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.568189 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.569549 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.580723 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.580993 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.582490 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.589083 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.589355 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:27:04.602737 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f7b7a0b-ea36-4100-8689-27bb9f6833a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b40ef0>]}
2022-06-19 21:27:04.606846 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f7b7a0b-ea36-4100-8689-27bb9f6833a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c04748>]}
2022-06-19 21:27:04.607089 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:27:04.608120 (MainThread): 
2022-06-19 21:27:04.608435 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:27:04.609393 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 21:27:04.609600 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-06-19 21:27:04.617475 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:27:05.086653 (MainThread): 17:27:05 | Concurrency: 1 threads (target='dev')
2022-06-19 21:27:05.087587 (MainThread): 17:27:05 | 
2022-06-19 21:27:05.090759 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2022-06-19 21:27:05.091077 (Thread-1): 17:27:05 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2022-06-19 21:27:05.091451 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2022-06-19 21:27:05.091639 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2022-06-19 21:27:05.096237 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2022-06-19 21:27:05.096805 (Thread-1): finished collecting timing info
2022-06-19 21:27:05.099679 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50174), raddr=('142.251.40.138', 443)>
2022-06-19 21:27:05.099964 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50175), raddr=('142.251.40.234', 443)>
2022-06-19 21:27:05.115724 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2022-06-19 21:27:05.116492 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:27:05.124110 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2022-06-19 21:27:06.580123 (Thread-1): finished collecting timing info
2022-06-19 21:27:06.580655 (Thread-1): 17:27:06 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 1.49s]
2022-06-19 21:27:06.580861 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2022-06-19 21:27:06.581082 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:27:06.581536 (Thread-1): 17:27:06 | 2 of 9 START test not_null_customers_customer_id..................... [RUN]
2022-06-19 21:27:06.581881 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d".
2022-06-19 21:27:06.582089 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:27:06.582774 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50176), raddr=('142.251.40.138', 443)>
2022-06-19 21:27:06.583048 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50177), raddr=('142.251.40.234', 443)>
2022-06-19 21:27:06.587513 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2022-06-19 21:27:06.587988 (Thread-1): finished collecting timing info
2022-06-19 21:27:06.589325 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2022-06-19 21:27:06.589661 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:27:06.597004 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
where customer_id is null



      
    ) dbt_internal_test
2022-06-19 21:27:08.188091 (Thread-1): finished collecting timing info
2022-06-19 21:27:08.189828 (Thread-1): 17:27:08 | 2 of 9 PASS not_null_customers_customer_id........................... [PASS in 1.61s]
2022-06-19 21:27:08.190201 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:27:08.190507 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:27:08.190727 (Thread-1): 17:27:08 | 3 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2022-06-19 21:27:08.191259 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2022-06-19 21:27:08.191482 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:27:08.194391 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2022-06-19 21:27:08.194879 (Thread-1): finished collecting timing info
2022-06-19 21:27:08.196284 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2022-06-19 21:27:08.196646 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:27:08.204188 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
2022-06-19 21:27:09.590871 (Thread-1): finished collecting timing info
2022-06-19 21:27:09.591598 (Thread-1): 17:27:09 | 3 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 1.40s]
2022-06-19 21:27:09.591812 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:27:09.592041 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2022-06-19 21:27:09.592236 (Thread-1): 17:27:09 | 4 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2022-06-19 21:27:09.592615 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5".
2022-06-19 21:27:09.592898 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2022-06-19 21:27:09.595899 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
2022-06-19 21:27:09.596367 (Thread-1): finished collecting timing info
2022-06-19 21:27:09.597579 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
2022-06-19 21:27:09.597912 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:27:09.605273 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
where customer_id is null



      
    ) dbt_internal_test
2022-06-19 21:27:10.993551 (Thread-1): finished collecting timing info
2022-06-19 21:27:10.994333 (Thread-1): 17:27:10 | 4 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 1.40s]
2022-06-19 21:27:10.994557 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2022-06-19 21:27:10.994839 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:27:10.995083 (Thread-1): 17:27:10 | 5 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2022-06-19 21:27:10.995485 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2022-06-19 21:27:10.995706 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:27:10.998580 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2022-06-19 21:27:10.999056 (Thread-1): finished collecting timing info
2022-06-19 21:27:11.000391 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2022-06-19 21:27:11.000777 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:27:11.008281 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
2022-06-19 21:27:12.356194 (Thread-1): finished collecting timing info
2022-06-19 21:27:12.357196 (Thread-1): 17:27:12 | 5 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 1.36s]
2022-06-19 21:27:12.357452 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:27:12.357726 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2022-06-19 21:27:12.358056 (Thread-1): 17:27:12 | 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2022-06-19 21:27:12.358403 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2022-06-19 21:27:12.358630 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2022-06-19 21:27:12.359412 (Thread-1): unclosed <ssl.SSLSocket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50184), raddr=('142.251.40.138', 443)>
2022-06-19 21:27:12.359700 (Thread-1): unclosed <ssl.SSLSocket fd=17, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50185), raddr=('142.251.40.234', 443)>
2022-06-19 21:27:12.363213 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2022-06-19 21:27:12.363731 (Thread-1): finished collecting timing info
2022-06-19 21:27:12.364615 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50179), raddr=('142.251.40.234', 443)>
2022-06-19 21:27:12.364846 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50178), raddr=('142.251.40.138', 443)>
2022-06-19 21:27:12.365060 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50180), raddr=('142.251.40.138', 443)>
2022-06-19 21:27:12.365253 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50181), raddr=('142.251.40.234', 443)>
2022-06-19 21:27:12.365449 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50182), raddr=('142.251.40.138', 443)>
2022-06-19 21:27:12.365632 (Thread-1): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50183), raddr=('142.251.40.234', 443)>
2022-06-19 21:27:12.367014 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2022-06-19 21:27:12.367359 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:27:12.374808 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2022-06-19 21:27:13.995055 (Thread-1): finished collecting timing info
2022-06-19 21:27:13.996059 (Thread-1): 17:27:13 | 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 1.64s]
2022-06-19 21:27:13.996298 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2022-06-19 21:27:13.996548 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:27:13.996852 (Thread-1): 17:27:13 | 7 of 9 START test unique_customers_customer_id....................... [RUN]
2022-06-19 21:27:13.997171 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1".
2022-06-19 21:27:13.997350 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:27:14.002510 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2022-06-19 21:27:14.002979 (Thread-1): finished collecting timing info
2022-06-19 21:27:14.004266 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2022-06-19 21:27:14.004593 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:27:14.012058 (Thread-1): On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2022-06-19 21:27:15.836938 (Thread-1): finished collecting timing info
2022-06-19 21:27:15.837472 (Thread-1): 17:27:15 | 7 of 9 PASS unique_customers_customer_id............................. [PASS in 1.84s]
2022-06-19 21:27:15.837687 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:27:15.837902 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:27:15.838267 (Thread-1): 17:27:15 | 8 of 9 START test unique_stg_customers_customer_id................... [RUN]
2022-06-19 21:27:15.838606 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2022-06-19 21:27:15.838794 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:27:15.839575 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50188), raddr=('142.251.40.138', 443)>
2022-06-19 21:27:15.839867 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50189), raddr=('142.251.40.234', 443)>
2022-06-19 21:27:15.842395 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2022-06-19 21:27:15.842858 (Thread-1): finished collecting timing info
2022-06-19 21:27:15.844139 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2022-06-19 21:27:15.844479 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:27:15.851884 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2022-06-19 21:27:17.476527 (Thread-1): finished collecting timing info
2022-06-19 21:27:17.477413 (Thread-1): 17:27:17 | 8 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 1.64s]
2022-06-19 21:27:17.477636 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:27:17.477858 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:27:17.478185 (Thread-1): 17:27:17 | 9 of 9 START test unique_stg_orders_order_id......................... [RUN]
2022-06-19 21:27:17.478546 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2022-06-19 21:27:17.478738 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:27:17.481701 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2022-06-19 21:27:17.482176 (Thread-1): finished collecting timing info
2022-06-19 21:27:17.483469 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2022-06-19 21:27:17.483803 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:27:17.491034 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2022-06-19 21:27:18.900971 (Thread-1): finished collecting timing info
2022-06-19 21:27:18.901934 (Thread-1): 17:27:18 | 9 of 9 PASS unique_stg_orders_order_id............................... [PASS in 1.42s]
2022-06-19 21:27:18.902177 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:27:18.983455 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:27:18.983838 (MainThread): 17:27:18 | 
2022-06-19 21:27:18.984021 (MainThread): 17:27:18 | Finished running 9 tests in 14.38s.
2022-06-19 21:27:18.984190 (MainThread): Connection 'master' was properly closed.
2022-06-19 21:27:18.984395 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
2022-06-19 21:27:18.988958 (MainThread): 
2022-06-19 21:27:18.989183 (MainThread): Completed successfully
2022-06-19 21:27:18.989372 (MainThread): 
Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
2022-06-19 21:27:18.989599 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d75588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b85080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b856d8>]}
2022-06-19 21:27:18.989837 (MainThread): Flushing usage events
2022-06-19 21:30:00.970483 (MainThread): Running with dbt=0.21.1
2022-06-19 21:30:01.213773 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=['customers'], selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-06-19 21:30:01.214927 (MainThread): Tracking: tracking
2022-06-19 21:30:01.227460 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124be630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124be828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124bea20>]}
2022-06-19 21:30:01.238190 (MainThread): Partial parsing not enabled
2022-06-19 21:30:01.247653 (MainThread): Parsing macros/etc.sql
2022-06-19 21:30:01.250125 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:30:01.256306 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:30:01.277393 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:30:01.279689 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:30:01.282024 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:30:01.290726 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:30:01.293063 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:30:01.306353 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:30:01.307807 (MainThread): Parsing macros/core.sql
2022-06-19 21:30:01.311100 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:30:01.317146 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:30:01.326037 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:30:01.327505 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:30:01.343086 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:30:01.375124 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:30:01.396657 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:30:01.398292 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:30:01.407951 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:30:01.427133 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:30:01.440409 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:30:01.448129 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:30:01.455076 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:30:01.458550 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:30:01.459878 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:30:01.460734 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:30:01.462116 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:30:01.470086 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:30:01.471710 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:30:01.473917 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:30:01.475311 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:30:01.526190 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:30:01.527734 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:30:01.528772 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:30:01.529972 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:30:01.703456 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:30:01.714888 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:30:01.720529 (MainThread): 1699: statically parsed staging/stg_orders.sql
2022-06-19 21:30:01.726023 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:30:01.727574 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '78e98b76-8729-4cc0-998a-5082e20bc701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125e3198>]}
2022-06-19 21:30:01.780853 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.782362 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.783780 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.785303 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.786662 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.788027 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.799664 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.799944 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.801419 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.807740 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.808141 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:30:01.821033 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78e98b76-8729-4cc0-998a-5082e20bc701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11260c748>]}
2022-06-19 21:30:01.825138 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78e98b76-8729-4cc0-998a-5082e20bc701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112603b38>]}
2022-06-19 21:30:01.825386 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:30:01.826197 (MainThread): 
2022-06-19 21:30:01.826525 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:30:01.827405 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 21:30:01.827645 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-06-19 21:30:01.835687 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:30:02.217323 (MainThread): 17:30:02 | Concurrency: 1 threads (target='dev')
2022-06-19 21:30:02.218387 (MainThread): 17:30:02 | 
2022-06-19 21:30:02.221079 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:30:02.221368 (Thread-1): 17:30:02 | 1 of 2 START test not_null_customers_customer_id..................... [RUN]
2022-06-19 21:30:02.221740 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d".
2022-06-19 21:30:02.221935 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:30:02.226575 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2022-06-19 21:30:02.227025 (Thread-1): finished collecting timing info
2022-06-19 21:30:02.244812 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2022-06-19 21:30:02.245300 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:30:02.252856 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
where customer_id is null



      
    ) dbt_internal_test
2022-06-19 21:30:04.068179 (Thread-1): finished collecting timing info
2022-06-19 21:30:04.068940 (Thread-1): 17:30:04 | 1 of 2 PASS not_null_customers_customer_id........................... [PASS in 1.85s]
2022-06-19 21:30:04.069167 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:30:04.069403 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:30:04.069702 (Thread-1): 17:30:04 | 2 of 2 START test unique_customers_customer_id....................... [RUN]
2022-06-19 21:30:04.070058 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1".
2022-06-19 21:30:04.070247 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:30:04.070912 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50215), raddr=('142.251.40.138', 443)>
2022-06-19 21:30:04.071220 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50216), raddr=('142.251.40.234', 443)>
2022-06-19 21:30:04.076200 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2022-06-19 21:30:04.076672 (Thread-1): finished collecting timing info
2022-06-19 21:30:04.077913 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2022-06-19 21:30:04.078256 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:30:04.085640 (Thread-1): On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2022-06-19 21:30:07.153710 (Thread-1): finished collecting timing info
2022-06-19 21:30:07.154651 (Thread-1): 17:30:07 | 2 of 2 PASS unique_customers_customer_id............................. [PASS in 3.08s]
2022-06-19 21:30:07.154882 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:30:07.230996 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:30:07.231380 (MainThread): 17:30:07 | 
2022-06-19 21:30:07.231559 (MainThread): 17:30:07 | Finished running 2 tests in 5.40s.
2022-06-19 21:30:07.231729 (MainThread): Connection 'master' was properly closed.
2022-06-19 21:30:07.231876 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
2022-06-19 21:30:07.236099 (MainThread): 
2022-06-19 21:30:07.236286 (MainThread): Completed successfully
2022-06-19 21:30:07.236505 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-06-19 21:30:07.236788 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edeecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edeee10>]}
2022-06-19 21:30:07.237035 (MainThread): Flushing usage events
2022-06-19 21:34:53.338867 (MainThread): Running with dbt=0.21.1
2022-06-19 21:34:53.583931 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2022-06-19 21:34:53.585002 (MainThread): Tracking: tracking
2022-06-19 21:34:53.597671 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ed7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ed7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ed828>]}
2022-06-19 21:34:53.608196 (MainThread): Partial parsing not enabled
2022-06-19 21:34:53.617928 (MainThread): Parsing macros/etc.sql
2022-06-19 21:34:53.620428 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:34:53.626498 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:34:53.647229 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:34:53.649498 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:34:53.651800 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:34:53.660500 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:34:53.662882 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:34:53.676391 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:34:53.677857 (MainThread): Parsing macros/core.sql
2022-06-19 21:34:53.681185 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:34:53.687284 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:34:53.696229 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:34:53.697711 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:34:53.713404 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:34:53.744779 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:34:53.765765 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:34:53.767397 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:34:53.776884 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:34:53.795494 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:34:53.808541 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:34:53.816170 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:34:53.823058 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:34:53.826528 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:34:53.827852 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:34:53.828720 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:34:53.830096 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:34:53.837957 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:34:53.839575 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:34:53.841813 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:34:53.843224 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:34:53.893127 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:34:53.894628 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:34:53.895661 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:34:53.896833 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:34:54.069821 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:34:54.080826 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:34:54.083086 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:34:54.136695 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:34:54.138193 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:34:54.139588 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:34:54.141104 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:34:54.142459 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:34:54.143796 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:34:54.154923 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:34:54.155200 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:34:54.168837 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eec84ca0-e055-44d1-8e61-739a6019eadd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e49e8>]}
2022-06-19 21:34:54.172846 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eec84ca0-e055-44d1-8e61-739a6019eadd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11218b400>]}
2022-06-19 21:34:54.173083 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:34:54.173995 (MainThread): 
2022-06-19 21:34:54.174310 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:34:54.175013 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 21:34:54.175262 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-06-19 21:34:54.183146 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:34:54.682766 (MainThread): 17:34:54 | Concurrency: 1 threads (target='dev')
2022-06-19 21:34:54.683544 (MainThread): 17:34:54 | 
2022-06-19 21:34:54.686178 (Thread-1): Began running node model.jaffle_shop.stg_customers
2022-06-19 21:34:54.686649 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:34:54.686845 (Thread-1): Compiling model.jaffle_shop.stg_customers
2022-06-19 21:34:54.688070 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2022-06-19 21:34:54.688526 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.688717 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.689072 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2022-06-19 21:34:54.689253 (Thread-1): Began running node model.jaffle_shop.stg_orders
2022-06-19 21:34:54.689582 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:34:54.689764 (Thread-1): Compiling model.jaffle_shop.stg_orders
2022-06-19 21:34:54.690742 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2022-06-19 21:34:54.691102 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.691277 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.691543 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2022-06-19 21:34:54.691723 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:34:54.691982 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2022-06-19 21:34:54.692138 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:34:54.696712 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2022-06-19 21:34:54.697292 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.697484 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.697777 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:34:54.697967 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:34:54.698260 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2022-06-19 21:34:54.698420 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:34:54.699267 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50246), raddr=('142.250.72.106', 443)>
2022-06-19 21:34:54.699528 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50247), raddr=('142.251.40.234', 443)>
2022-06-19 21:34:54.703826 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2022-06-19 21:34:54.704187 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.704375 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.704662 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:34:54.704858 (Thread-1): Began running node model.jaffle_shop.customers
2022-06-19 21:34:54.705161 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:34:54.705321 (Thread-1): Compiling model.jaffle_shop.customers
2022-06-19 21:34:54.707773 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2022-06-19 21:34:54.708114 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.708300 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.708590 (Thread-1): Finished running node model.jaffle_shop.customers
2022-06-19 21:34:54.708829 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2022-06-19 21:34:54.709204 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2022-06-19 21:34:54.709388 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2022-06-19 21:34:54.713455 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2022-06-19 21:34:54.713997 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.714202 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.714539 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2022-06-19 21:34:54.714751 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:34:54.715099 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2022-06-19 21:34:54.715272 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:34:54.718036 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2022-06-19 21:34:54.718466 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.718660 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.718954 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:34:54.719158 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:34:54.719457 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2022-06-19 21:34:54.719617 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:34:54.721963 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2022-06-19 21:34:54.722280 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.722465 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.722744 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:34:54.722937 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:34:54.723224 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d".
2022-06-19 21:34:54.723383 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:34:54.725696 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2022-06-19 21:34:54.726036 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.726218 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.726495 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:34:54.726682 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:34:54.726970 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1".
2022-06-19 21:34:54.727129 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:34:54.729493 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2022-06-19 21:34:54.729825 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.730010 (Thread-1): finished collecting timing info
2022-06-19 21:34:54.730291 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:34:54.790975 (MainThread): Connection 'master' was properly closed.
2022-06-19 21:34:54.791134 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
2022-06-19 21:34:54.794767 (MainThread): 17:34:54 | Done.
2022-06-19 21:34:54.797987 (MainThread): Acquiring new bigquery connection "generate_catalog".
2022-06-19 21:34:54.798165 (MainThread): 17:34:54 | Building catalog
2022-06-19 21:34:54.799017 (MainThread): Opening a new connection, currently in state init
2022-06-19 21:34:55.234719 (MainThread): Skipping catalog for agonzalez-dbt-tutorial.dbt_agonzalez_dbt_test__audit - schema does not exist
2022-06-19 21:34:55.237374 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "agonzalez-dbt-tutorial.information_schema".
2022-06-19 21:34:55.250455 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-06-19 21:34:55.257967 (ThreadPoolExecutor-1_0): On agonzalez-dbt-tutorial.information_schema: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "agonzalez-dbt-tutorial.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.__TABLES__
        where (upper(dataset_id) = upper('dbt_agonzalez'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2022-06-19 21:34:57.914175 (MainThread): 17:34:57 | Catalog written to /Users/agonzalez/dev/personal/dbt-tutorial/jaffle_shop/target/catalog.json
2022-06-19 21:34:57.914451 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112150240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112345208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112345940>]}
2022-06-19 21:34:57.914744 (MainThread): Flushing usage events
2022-06-19 21:34:58.108775 (MainThread): Connection 'generate_catalog' was properly closed.
2022-06-19 21:34:58.109840 (MainThread): Connection 'agonzalez-dbt-tutorial.information_schema' was properly closed.
2022-06-19 21:35:15.577225 (MainThread): Running with dbt=0.21.1
2022-06-19 21:35:15.822719 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2022-06-19 21:35:15.823916 (MainThread): Tracking: tracking
2022-06-19 21:35:15.838227 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dd07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dd0518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dd09b0>]}
2022-06-19 21:35:15.840203 (MainThread): Serving docs at 0.0.0.0:8080
2022-06-19 21:35:15.840479 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2022-06-19 21:35:15.840731 (MainThread): Press Ctrl+C to exit.


2022-06-19 21:37:13.615547 (MainThread): Flushing usage events
2022-06-19 21:37:13.821565 (MainThread): ctrl-c
2022-06-19 21:38:12.339128 (MainThread): Running with dbt=0.21.1
2022-06-19 21:38:12.609116 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-06-19 21:38:12.610229 (MainThread): Tracking: tracking
2022-06-19 21:38:12.623038 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112526cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112526860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112526a90>]}
2022-06-19 21:38:12.634141 (MainThread): Partial parsing not enabled
2022-06-19 21:38:12.645635 (MainThread): Parsing macros/etc.sql
2022-06-19 21:38:12.648328 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:38:12.654836 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:38:12.675977 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:38:12.678293 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:38:12.680614 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:38:12.689291 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:38:12.691678 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:38:12.704996 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:38:12.706442 (MainThread): Parsing macros/core.sql
2022-06-19 21:38:12.709754 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:38:12.715859 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:38:12.724753 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:38:12.726253 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:38:12.742259 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:38:12.776000 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:38:12.797684 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:38:12.799260 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:38:12.808991 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:38:12.828178 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:38:12.841374 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:38:12.849285 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:38:12.856413 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:38:12.859856 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:38:12.861189 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:38:12.862048 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:38:12.863435 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:38:12.871356 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:38:12.872978 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:38:12.875182 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:38:12.876588 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:38:12.927614 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:38:12.929126 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:38:12.930168 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:38:12.931362 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:38:13.103207 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:38:13.114333 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:38:13.116599 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:38:13.170415 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:38:13.171901 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:38:13.173295 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:38:13.174795 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:38:13.176157 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:38:13.177509 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:38:13.188411 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:38:13.188682 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:38:13.202066 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc86c20a-7bbe-4e67-96d1-d4606be0c89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125d1a90>]}
2022-06-19 21:38:13.205865 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc86c20a-7bbe-4e67-96d1-d4606be0c89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125d79e8>]}
2022-06-19 21:38:13.206102 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:38:13.207132 (MainThread): 
2022-06-19 21:38:13.207485 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:38:13.208393 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 21:38:13.208610 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-06-19 21:38:13.216630 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:38:13.627204 (MainThread): 17:38:13 | Concurrency: 1 threads (target='dev')
2022-06-19 21:38:13.628268 (MainThread): 17:38:13 | 
2022-06-19 21:38:13.631678 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned.0fe0062ab6
2022-06-19 21:38:13.631954 (Thread-1): 17:38:13 | 1 of 7 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned [RUN]
2022-06-19 21:38:13.632312 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned.0fe0062ab6".
2022-06-19 21:38:13.632500 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned.0fe0062ab6
2022-06-19 21:38:13.636594 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned.0fe0062ab6"
2022-06-19 21:38:13.637044 (Thread-1): finished collecting timing info
2022-06-19 21:38:13.654775 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned.0fe0062ab6"
2022-06-19 21:38:13.655396 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:38:13.663025 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned.0fe0062ab6: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned.0fe0062ab6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2022-06-19 21:38:14.937795 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50284), raddr=('142.250.72.106', 443)>
2022-06-19 21:38:14.939241 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50285), raddr=('142.251.40.234', 443)>
2022-06-19 21:38:15.198220 (Thread-1): finished collecting timing info
2022-06-19 21:38:15.198737 (Thread-1): 17:38:15 | 1 of 7 FAIL 1 accepted_values_stg_orders_status__shipped__completed__return_pending__returned [FAIL 1 in 1.57s]
2022-06-19 21:38:15.198941 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned.0fe0062ab6
2022-06-19 21:38:15.199158 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:38:15.199474 (Thread-1): 17:38:15 | 2 of 7 START test not_null_customers_customer_id..................... [RUN]
2022-06-19 21:38:15.199908 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d".
2022-06-19 21:38:15.200097 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:38:15.205091 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2022-06-19 21:38:15.205545 (Thread-1): finished collecting timing info
2022-06-19 21:38:15.206871 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2022-06-19 21:38:15.207217 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:38:15.214624 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
where customer_id is null



      
    ) dbt_internal_test
2022-06-19 21:38:16.832423 (Thread-1): finished collecting timing info
2022-06-19 21:38:16.833869 (Thread-1): 17:38:16 | 2 of 7 PASS not_null_customers_customer_id........................... [PASS in 1.63s]
2022-06-19 21:38:16.834143 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2022-06-19 21:38:16.834409 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:38:16.834756 (Thread-1): 17:38:16 | 3 of 7 START test not_null_stg_customers_customer_id................. [RUN]
2022-06-19 21:38:16.835153 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2022-06-19 21:38:16.835374 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:38:16.836163 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50288), raddr=('142.250.72.106', 443)>
2022-06-19 21:38:16.836460 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50289), raddr=('142.251.40.234', 443)>
2022-06-19 21:38:16.838859 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2022-06-19 21:38:16.839307 (Thread-1): finished collecting timing info
2022-06-19 21:38:16.840566 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2022-06-19 21:38:16.840923 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:38:16.848459 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
2022-06-19 21:38:18.030650 (Thread-1): finished collecting timing info
2022-06-19 21:38:18.031913 (Thread-1): 17:38:18 | 3 of 7 PASS not_null_stg_customers_customer_id....................... [PASS in 1.20s]
2022-06-19 21:38:18.032215 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:38:18.032450 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:38:18.032775 (Thread-1): 17:38:18 | 4 of 7 START test not_null_stg_orders_order_id....................... [RUN]
2022-06-19 21:38:18.033114 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2022-06-19 21:38:18.033314 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:38:18.034101 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50290), raddr=('142.250.72.106', 443)>
2022-06-19 21:38:18.034421 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50291), raddr=('142.251.40.234', 443)>
2022-06-19 21:38:18.037014 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2022-06-19 21:38:18.037566 (Thread-1): finished collecting timing info
2022-06-19 21:38:18.038830 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2022-06-19 21:38:18.039188 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:38:18.046710 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
2022-06-19 21:38:19.390592 (Thread-1): finished collecting timing info
2022-06-19 21:38:19.391714 (Thread-1): 17:38:19 | 4 of 7 PASS not_null_stg_orders_order_id............................. [PASS in 1.36s]
2022-06-19 21:38:19.391964 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:38:19.392202 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:38:19.392493 (Thread-1): 17:38:19 | 5 of 7 START test unique_customers_customer_id....................... [RUN]
2022-06-19 21:38:19.392845 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1".
2022-06-19 21:38:19.393030 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:38:19.398212 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2022-06-19 21:38:19.398676 (Thread-1): finished collecting timing info
2022-06-19 21:38:19.400055 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2022-06-19 21:38:19.400405 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:38:19.407938 (Thread-1): On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2022-06-19 21:38:21.060394 (Thread-1): finished collecting timing info
2022-06-19 21:38:21.061055 (Thread-1): 17:38:21 | 5 of 7 PASS unique_customers_customer_id............................. [PASS in 1.67s]
2022-06-19 21:38:21.061268 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2022-06-19 21:38:21.061489 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:38:21.061774 (Thread-1): 17:38:21 | 6 of 7 START test unique_stg_customers_customer_id................... [RUN]
2022-06-19 21:38:21.062130 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2022-06-19 21:38:21.062318 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:38:21.063090 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50294), raddr=('142.250.72.106', 443)>
2022-06-19 21:38:21.063383 (Thread-1): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50295), raddr=('142.251.40.234', 443)>
2022-06-19 21:38:21.065803 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2022-06-19 21:38:21.066270 (Thread-1): finished collecting timing info
2022-06-19 21:38:21.067525 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2022-06-19 21:38:21.067862 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:38:21.075426 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2022-06-19 21:38:22.258982 (Thread-1): finished collecting timing info
2022-06-19 21:38:22.259790 (Thread-1): 17:38:22 | 6 of 7 PASS unique_stg_customers_customer_id......................... [PASS in 1.20s]
2022-06-19 21:38:22.260010 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:38:22.260234 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:38:22.260533 (Thread-1): 17:38:22 | 7 of 7 START test unique_stg_orders_order_id......................... [RUN]
2022-06-19 21:38:22.260910 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2022-06-19 21:38:22.261101 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:38:22.262340 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50293), raddr=('142.251.40.234', 443)>
2022-06-19 21:38:22.262664 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50292), raddr=('142.250.72.106', 443)>
2022-06-19 21:38:22.262910 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50296), raddr=('142.250.72.106', 443)>
2022-06-19 21:38:22.263169 (Thread-1): unclosed <ssl.SSLSocket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50297), raddr=('142.251.40.234', 443)>
2022-06-19 21:38:22.265988 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2022-06-19 21:38:22.266438 (Thread-1): finished collecting timing info
2022-06-19 21:38:22.267698 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2022-06-19 21:38:22.268044 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:38:22.275469 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2022-06-19 21:38:23.721364 (Thread-1): finished collecting timing info
2022-06-19 21:38:23.722352 (Thread-1): 17:38:23 | 7 of 7 PASS unique_stg_orders_order_id............................... [PASS in 1.46s]
2022-06-19 21:38:23.722593 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:38:23.773055 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:38:23.773422 (MainThread): 17:38:23 | 
2022-06-19 21:38:23.773603 (MainThread): 17:38:23 | Finished running 7 tests in 10.57s.
2022-06-19 21:38:23.773768 (MainThread): Connection 'master' was properly closed.
2022-06-19 21:38:23.773919 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
2022-06-19 21:38:23.778149 (MainThread): 
2022-06-19 21:38:23.778356 (MainThread): Completed with 1 error and 0 warnings:
2022-06-19 21:38:23.778529 (MainThread): 
2022-06-19 21:38:23.778696 (MainThread): Failure in test accepted_values_stg_orders_status__shipped__completed__return_pending__returned (models/schema.yml)
2022-06-19 21:38:23.778855 (MainThread):   Got 1 result, configured to fail if != 0
2022-06-19 21:38:23.779010 (MainThread): 
2022-06-19 21:38:23.779168 (MainThread):   compiled SQL at target/compiled/jaffle_shop/models/schema.yml/schema_test/accepted_values_stg_orders_01c86adbc21585bf0e6b602a82a1abb1.sql
2022-06-19 21:38:23.779336 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2022-06-19 21:38:23.779552 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112726518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127cdf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112818e48>]}
2022-06-19 21:38:23.779780 (MainThread): Flushing usage events
2022-06-19 21:39:21.172450 (MainThread): Running with dbt=0.21.1
2022-06-19 21:39:21.421576 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/agonzalez/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=['staging'], selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-06-19 21:39:21.422778 (MainThread): Tracking: tracking
2022-06-19 21:39:21.435828 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f59828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f595c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f597b8>]}
2022-06-19 21:39:21.446564 (MainThread): Partial parsing not enabled
2022-06-19 21:39:21.456259 (MainThread): Parsing macros/etc.sql
2022-06-19 21:39:21.458785 (MainThread): Parsing macros/catalog.sql
2022-06-19 21:39:21.465070 (MainThread): Parsing macros/adapters.sql
2022-06-19 21:39:21.486142 (MainThread): Parsing macros/materializations/seed.sql
2022-06-19 21:39:21.488475 (MainThread): Parsing macros/materializations/view.sql
2022-06-19 21:39:21.490805 (MainThread): Parsing macros/materializations/table.sql
2022-06-19 21:39:21.499677 (MainThread): Parsing macros/materializations/copy.sql
2022-06-19 21:39:21.502090 (MainThread): Parsing macros/materializations/incremental.sql
2022-06-19 21:39:21.515911 (MainThread): Parsing macros/materializations/snapshot.sql
2022-06-19 21:39:21.517413 (MainThread): Parsing macros/core.sql
2022-06-19 21:39:21.520798 (MainThread): Parsing macros/materializations/test.sql
2022-06-19 21:39:21.526998 (MainThread): Parsing macros/materializations/helpers.sql
2022-06-19 21:39:21.536055 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-06-19 21:39:21.537568 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-06-19 21:39:21.553480 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-06-19 21:39:21.586724 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-06-19 21:39:21.608386 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-06-19 21:39:21.610003 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-06-19 21:39:21.619806 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-06-19 21:39:21.638702 (MainThread): Parsing macros/materializations/common/merge.sql
2022-06-19 21:39:21.651707 (MainThread): Parsing macros/materializations/table/table.sql
2022-06-19 21:39:21.659558 (MainThread): Parsing macros/materializations/view/view.sql
2022-06-19 21:39:21.666611 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-06-19 21:39:21.670041 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-06-19 21:39:21.671366 (MainThread): Parsing macros/etc/query.sql
2022-06-19 21:39:21.672209 (MainThread): Parsing macros/etc/is_incremental.sql
2022-06-19 21:39:21.673580 (MainThread): Parsing macros/etc/datetime.sql
2022-06-19 21:39:21.681401 (MainThread): Parsing macros/etc/where_subquery.sql
2022-06-19 21:39:21.683008 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-06-19 21:39:21.685223 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-06-19 21:39:21.686615 (MainThread): Parsing macros/adapters/common.sql
2022-06-19 21:39:21.737425 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-06-19 21:39:21.739075 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-06-19 21:39:21.740132 (MainThread): Parsing macros/schema_tests/unique.sql
2022-06-19 21:39:21.741335 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-06-19 21:39:21.916066 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2022-06-19 21:39:21.927176 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2022-06-19 21:39:21.929459 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2022-06-19 21:39:21.984533 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:39:21.986014 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:39:21.987379 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:39:21.988873 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:39:21.990199 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:39:21.991519 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:39:22.002434 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:39:22.002745 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-06-19 21:39:22.016053 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ff74a4e-99d3-4d49-8e1f-8d572630b51d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f8ae80>]}
2022-06-19 21:39:22.019922 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ff74a4e-99d3-4d49-8e1f-8d572630b51d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fb7ba8>]}
2022-06-19 21:39:22.020175 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-06-19 21:39:22.021039 (MainThread): 
2022-06-19 21:39:22.021380 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:39:22.022475 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_agonzalez-dbt-tutorial_dbt_agonzalez".
2022-06-19 21:39:22.022711 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-06-19 21:39:22.030580 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2022-06-19 21:39:22.419955 (MainThread): 17:39:22 | Concurrency: 1 threads (target='dev')
2022-06-19 21:39:22.420952 (MainThread): 17:39:22 | 
2022-06-19 21:39:22.423661 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2022-06-19 21:39:22.423932 (Thread-1): 17:39:22 | 1 of 5 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2022-06-19 21:39:22.424353 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2022-06-19 21:39:22.424542 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2022-06-19 21:39:22.428925 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2022-06-19 21:39:22.429388 (Thread-1): finished collecting timing info
2022-06-19 21:39:22.447096 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2022-06-19 21:39:22.447650 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:39:22.455336 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2022-06-19 21:39:23.452351 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50313), raddr=('142.250.72.106', 443)>
2022-06-19 21:39:23.453911 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50314), raddr=('142.251.40.234', 443)>
2022-06-19 21:39:23.697691 (Thread-1): finished collecting timing info
2022-06-19 21:39:23.698393 (Thread-1): 17:39:23 | 1 of 5 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 1.27s]
2022-06-19 21:39:23.698605 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2022-06-19 21:39:23.698821 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:39:23.699180 (Thread-1): 17:39:23 | 2 of 5 START test not_null_stg_customers_customer_id................. [RUN]
2022-06-19 21:39:23.699614 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2022-06-19 21:39:23.699803 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:39:23.704892 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2022-06-19 21:39:23.705374 (Thread-1): finished collecting timing info
2022-06-19 21:39:23.706693 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2022-06-19 21:39:23.707034 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:39:23.714643 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
2022-06-19 21:39:24.865251 (Thread-1): finished collecting timing info
2022-06-19 21:39:24.865907 (Thread-1): 17:39:24 | 2 of 5 PASS not_null_stg_customers_customer_id....................... [PASS in 1.17s]
2022-06-19 21:39:24.866127 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2022-06-19 21:39:24.866355 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:39:24.866552 (Thread-1): 17:39:24 | 3 of 5 START test not_null_stg_orders_order_id....................... [RUN]
2022-06-19 21:39:24.867007 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2022-06-19 21:39:24.867361 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:39:24.868184 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50317), raddr=('142.251.40.170', 443)>
2022-06-19 21:39:24.868524 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50318), raddr=('142.251.40.234', 443)>
2022-06-19 21:39:24.871115 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2022-06-19 21:39:24.871571 (Thread-1): finished collecting timing info
2022-06-19 21:39:24.872848 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2022-06-19 21:39:24.873187 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:39:24.880455 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
2022-06-19 21:39:26.157592 (Thread-1): finished collecting timing info
2022-06-19 21:39:26.158425 (Thread-1): 17:39:26 | 3 of 5 PASS not_null_stg_orders_order_id............................. [PASS in 1.29s]
2022-06-19 21:39:26.158631 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2022-06-19 21:39:26.158902 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:39:26.159136 (Thread-1): 17:39:26 | 4 of 5 START test unique_stg_customers_customer_id................... [RUN]
2022-06-19 21:39:26.159521 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2022-06-19 21:39:26.159714 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:39:26.160438 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50319), raddr=('142.251.40.170', 443)>
2022-06-19 21:39:26.160741 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.221', 50320), raddr=('142.251.40.234', 443)>
2022-06-19 21:39:26.165325 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2022-06-19 21:39:26.165850 (Thread-1): finished collecting timing info
2022-06-19 21:39:26.167152 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2022-06-19 21:39:26.167490 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:39:26.174860 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2022-06-19 21:39:27.488546 (Thread-1): finished collecting timing info
2022-06-19 21:39:27.490154 (Thread-1): 17:39:27 | 4 of 5 PASS unique_stg_customers_customer_id......................... [PASS in 1.33s]
2022-06-19 21:39:27.490442 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2022-06-19 21:39:27.490679 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:39:27.491007 (Thread-1): 17:39:27 | 5 of 5 START test unique_stg_orders_order_id......................... [RUN]
2022-06-19 21:39:27.491399 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2022-06-19 21:39:27.491587 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:39:27.494503 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2022-06-19 21:39:27.494951 (Thread-1): finished collecting timing info
2022-06-19 21:39:27.496254 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2022-06-19 21:39:27.496574 (Thread-1): Opening a new connection, currently in state closed
2022-06-19 21:39:27.503994 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `agonzalez-dbt-tutorial`.`dbt_agonzalez`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2022-06-19 21:39:29.127508 (Thread-1): finished collecting timing info
2022-06-19 21:39:29.128065 (Thread-1): 17:39:29 | 5 of 5 PASS unique_stg_orders_order_id............................... [PASS in 1.64s]
2022-06-19 21:39:29.128276 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2022-06-19 21:39:29.173511 (MainThread): Acquiring new bigquery connection "master".
2022-06-19 21:39:29.173917 (MainThread): 17:39:29 | 
2022-06-19 21:39:29.174105 (MainThread): 17:39:29 | Finished running 5 tests in 7.15s.
2022-06-19 21:39:29.174276 (MainThread): Connection 'master' was properly closed.
2022-06-19 21:39:29.174474 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
2022-06-19 21:39:29.178812 (MainThread): 
2022-06-19 21:39:29.179108 (MainThread): Completed successfully
2022-06-19 21:39:29.179296 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-06-19 21:39:29.179601 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114175518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11413cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108245f8>]}
2022-06-19 21:39:29.179911 (MainThread): Flushing usage events
